var nmleft,nmtop;function openDialog(e,t,a,s,n){var i,o="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex=0], *[contenteditable]",r=$("#contentarea [tabindex]"),l=getTabIndices(r),c=["one","two","three","four","five","six","seven","eight","nine","ten"][a-1];switch(updateState("dialog","open"),t.addClass("dialog-originator"),e){case"maxSelection":(i=$("#modal-max-selection")).find("span").html(c);break;case"nextSection":i=$("#modal-next-section");break;case"timeOut":i=$("#modal-time-out");break;case"itemError":i=$("#modal-item-error");break;case"nextSectionSBT":i=$("#modal-next-section-SBT");break;case"endOfAssessment":i=$("#modal-end-assessment");break;case"SqIncomplete":i=$("#modal-sq-incomplete");break;case"SqInvalidZip":i=$("#modal-sq-invalid-zip");break;case"SbtSubmit":i=$("#modal-sbt-submit");break;case"nonModal":i=$("#non-modal");break;case"neValidation":i=$("#modal-ne-validation");break;case"validation":i=$("#modal-validation"),validation(a,s,n);break;default:return!1}i.removeClass("hidden"),i.find(".close-dialog").click(function(){closeDialog(i),reFocusEls(r,l)}),i.find(o).first().focus(),i.is($("#non-modal"))?i.find(".dialog-content").css({left:nmleft+"px",top:nmtop+"px"}):$("#contentarea").find(o).attr("tabindex",-1)}function getTabIndices(e){var t=[];return e.each(function(e){t[e]=$(this).attr("tabindex")}),t}function reFocusEls(e,t){$("#contentarea").find("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex=0], *[contenteditable]").removeAttr("tabindex"),e.each(function(e){$(this).attr("tabindex",t[e])})}function validation(e,t,a){var s=$("#modal-validation");$(".dialog-originator").hasClass("extendedtext")||$(".dialog-originator").is("#wri-editor-actual")||$(".dialog-originator").is(".btn-max-character")?s.find("p").html("You have reached the maximum amount you can type.<br /><br /> To type something else, you must remove some of what you already typed."):$.isNumeric(e)&&$.isNumeric(t)?(s.find("p").html("You can only enter a number between <span></span> and <span></span>."),s.find("span").first().html(e),s.find("span").last().html(t)):$.isNumeric(e)&&!$.isNumeric(t)?(fLength=e.toString().length,fLength<a?(s.find("p").html("You can only enter <span></span> numbers."),s.find("span").first().html(a)):(s.find("p").html("You can only enter a number that is <span></span> or more."),s.find("span").first().html(e))):!$.isNumeric(e)&&$.isNumeric(t)?(s.find("p").html("You can only enter a number that is <span></span> or less."),s.find("span").first().html(t)):$.isNumeric(e)||$.isNumeric(t)||!$(".dialog-originator").hasClass("fib")?$.isNumeric(e)||$.isNumeric(t)||!$.isNumeric(a)?$.isNumeric(e)||$.isNumeric(t)||$.isNumeric(a)||s.find("p").html("You can only enter numbers."):(s.find("p").html("You can only enter <span></span> numbers."),s.find("span").first().html(a)):s.find("p").html("You have reached the maximum amount you can type.<br /><br /> To type something else, you must remove some of what you already typed.")}function closeDialog(e){if(enableUI(),turnOffTTS(),state.tts="off",e.addClass("hidden"),$(".dialog-originator").focus(),$(".dialog-originator").removeClass("dialog-originator"),updateState("dialog","closed"),e.is($("#non-modal"))){var t=e.find(".dialog-content"),a=parseInt(t.css("margin-left")),s=parseInt(t.css("margin-top")),n=$(".btn-non-modal"),i=n.offset().left,o=n.offset().top;nmleft=t.offset().left-a,nmtop=t.offset().top-s,t.css({left:i+"px",top:o+"px"})}}if($(".accordion").each(function(e){$(this).css("font-weight","bold"),$(this).find("ul").css("display","block");var t=$(this).outerWidth();$(this).css({"min-width":t,"font-weight":""}),$(this).find("ul").css("display","")}),$(".accordion span").hover(function(){$(this).siblings("ul").length&&$(this).toggleClass("hover")}),$(".accordion span").click(function(){var e=$(this).parents("li").siblings("li"),t=$(this).siblings("ul");$(this).toggleClass("active"),t.length?($(this).toggleClass("dropdown"),t.slideToggle("fast"),$(this).hasClass("active")?t.children("li").children("span").attr("tabindex",0):t.children("li").children("span").attr("tabindex",-1)):$(this).hasClass("active")&&(e.find("span").removeClass("active").attr("tabindex",0),$(".accordion").find("span").eq(0).focus(),$(this).attr("tabindex",-1)),e.find("span.dropdown").removeClass("active dropdown"),e.find("ul").slideUp("fast")}),$(".accordion span").keydown(function(e){var t=$(this),a=t.parents(".accordion").find("span:not([tabindex=-1])"),s=a.index(t),n=a.eq(s-1),i=a.eq(s+1),o=a.first(),r=a.last();switch(e.which){case 13:case 32:e.preventDefault(),$(this).trigger("click");break;case 38:e.preventDefault(),n.focus();break;case 40:e.preventDefault(),t.is(r)?o.focus():i.focus();break;case 36:e.preventDefault(),o.focus();break;case 35:e.preventDefault(),r.focus()}}),$(".cta-submit-wrapper").children().click(function(){$(this).hasClass("tts-active")||($(this).parent().find(".btn").addClass("dialog-originator"),"function"==typeof openDialog?openDialog("SbtSubmit",$(this)):console.warn("Missing dialogs.js."))}),updateState(".childItem.selected .btn-submit","disabled"),$(".char-text-bare .char-portrait img").hover(function(e){$(this).parents(".char-portrait").siblings(".btn").toggleClass("hover")}),$(".char-text-bare .char-portrait img").mousedown(function(e){$(this).parents(".char-portrait").siblings(".btn").addClass("active")}),$(".char-text-bare .char-portrait img").mouseup(function(e){$(this).parents(".char-portrait").siblings(".btn").removeClass("active")}),$(".char-text-bare .char-portrait img").click(function(e){$(this).parents(".char-portrait").siblings(".btn").focus(),$(this).parents(".char-wrapper").toggleClass("char-vo-play")}),$(".btn-char-vo").hover(function(e){$(this).siblings(".char-portrait").find("img").toggleClass("hover")}),$(".btn-char-vo").click(function(e){$(this).parents(".char-wrapper").toggleClass("char-vo-play")}),$(".control input").keydown(function(e){var t=e.keyCode?e.keyCode:e.which,a=$(this);switch(t){case 13:e.preventDefault(),a.trigger("click")}}),$(function(){var e=$(".non-modal .dialog-content");e.length&&e.draggable({containment:".dialog"})}),$(document).keydown(function(e){var t=$(".non-modal");27!==e.which||t.hasClass("hidden")||closeDialog(t)}),$(".non-modal").length){var counter=0,backdrop=$(".dialog"),bdheight=backdrop.outerHeight()/2,bdwidth=backdrop.outerWidth()/2,nmcontent=$(".non-modal").find(".dialog-content"),nmheight=nmcontent.outerHeight(!0)/2,nmwidth=nmcontent.outerWidth(!0)/2,originator=$(".btn-non-modal"),orleft=originator.offset().left,ortop=originator.offset().top;nmcontent.css({left:orleft+"px",top:ortop+"px"}),$(".btn-non-modal").click(function(e){0===counter?(openDialog("nonModal",$(this)),nmcontent.css({left:bdwidth-nmwidth+"px",top:bdheight-nmheight+"px"}),counter++):$("#non-modal").hasClass("hidden")?openDialog("nonModal",$(this)):closeDialog($("#non-modal"))})}function PanelController(){"open"==state["ereader-panel"]?updateState("ereader-panel","closed"):"closed"==state["ereader-panel"]&&updateState("ereader-panel","open")}$(".btn-next-section").click(function(e){openDialog("nextSection",$(this))}),$("#QuestionsButton").click(function(e){PanelController()}),$("#mask").click(function(e){PanelController()}),function(){var o,e,r,t;bind=function(e,t){return function(){return e.apply(t,arguments)}},indexOf=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1},o=function(){function e(e){var t;t=null!=e?e:{},this.element=t.element,this.title=t.title,this.listitem=t.listitem,this.others=t.others,this.setInactive=bind(this.setInactive,this),this.setActive=bind(this.setActive,this),this.tab=$("<li class='item'>"+this.title+"</li>"),this.tab.click(this.setActive),$("ul.itemTab").append(this.tab),this.listitem=$("<li>Question "+this.title+"</li>"),$("#list-review").append(this.listitem)}return e.prototype.setActive=function(){var e,t,a;if(a=this.others,this.tab.hasClass("selected"))return!1;for(e=0,t=a.length;e<t;e++)a[e].setInactive();$("#enaepEreaderContainer").scrollTop(0),this.element.hasClass("large")?($("#QuestionsPanel").removeClass("medium"),$("#QuestionsPanel").addClass("large")):this.element.hasClass("medium")?($("#QuestionsPanel").removeClass("large"),$("#QuestionsPanel").addClass("medium")):($("#QuestionsPanel").removeClass("large"),$("#QuestionsPanel").removeClass("medium")),$("#enaepEreaderContainer").fadeOut(0).delay(250).fadeIn(200),this.element.show(),this.tab.addClass("selected"),this.element.addClass("selected"),"function"==typeof MoreBtnController&&MoreBtnController(300)},e.prototype.setInactive=function(){return this.element.hide(),this.element.removeClass("selected"),this.tab.removeClass("selected")},e}(),e=function(){var e,t,a,s,n,i;for(this.items=[],t=a=0,s=(n=$(".childItem")).length;a<s;t=++a)e=n[t],e=$(e),i=t+1,this.items.push(new o({element:e,title:i,others:this.items}));$("ul.itemTab li").eq(0).addClass("selected"),$("ul.itemTab li:last-child").html("Review"),$(".childItem").hide(),$(".childItem").eq(0).show(),$(".childItem").eq(0).addClass("selected"),$("#list-review li:last-of-type").remove(),$("div.childItem").eq(0).hasClass("large")?$("#QuestionsPanel").addClass("large"):$("div.childItem").eq(0).hasClass("medium")&&$("#QuestionsPanel").addClass("medium")},r=function(){function e(e){var t;t=null!=e?e:{},this.element=t.element,this.title=t.title,this.listitem=t.listitem,this.others=t.others,this.setInactive=bind(this.setInactive,this),this.setActive=bind(this.setActive,this),this.tab=$("<li class='stim'>"+this.title+"</li>"),this.tab.click(this.setActive),$("ul.stimTab").append(this.tab)}return e.prototype.setActive=function(){var e,t,a;if(a=this.others,this.tab.hasClass("selected"))return!1;for(e=0,t=a.length;e<t;e++)a[e].setInactive();$(".stim-container").fadeOut(0).delay(250).fadeIn(200),this.element.show(),this.tab.addClass("selected"),this.element.addClass("selected")},e.prototype.setInactive=function(){return this.element.hide(),this.element.removeClass("selected"),this.tab.removeClass("selected")},e}(),t=function(){var e,t,a,s,n,i;for(this.items=[],t=a=0,s=(n=$(".childStim")).length;a<s;t=++a)e=n[t],e=$(e),i=$(e).data("title"),this.items.push(new r({element:e,title:i,others:this.items}));$("ul.stimTab li:first-child").addClass("selected"),$(".childStim").hide(),$(".childStim").eq(0).show(),$(".childStim").eq(0).addClass("selected")},$(function(){return window.ItemTabGen=new e,window.StimTabGen=new t})}.call(this),$(document).click(function(e){var t=$(e.target);t.is(".ee-btnarea .ee-btn")||t.is(".ee-btnarea .ee-btn span")||t.is(".ee-btnarea .ee-btn i")||t.is(".ee-tabarea")||t.is(".ee-tabs li")||t.is(".ee-btnarea")||t.is(".ee-spacer")||t.is(".ee-btnarea-row")||t.is(".ee-btnarea-group")||t.is("#equation-btn")||t.is("#equation-btn span")||t.is("#ee-btn-close")||(t.is("textarea")||t.is("input[type=text]")?enableEquationEditor(t):disableEquationEditor(t))}),$(document).keypress(function(e){var t=$(e.target);t.is(".ee-btnarea .ee-btn")||t.is(".ee-btnarea .ee-btn span")||t.is(".ee-btnarea .ee-btn i")||t.is(".ee-tabarea")||t.is(".ee-tabs li")||t.is(".ee-btnarea-group")||(t.is("textarea")||t.is("input[type=text]")?enableEquationEditor(t):disableEquationEditor(t))}),$(".ee-tabs").on("keydown","li",function(e){switch(e.preventDefault(),e.which){case 9:if(e.shiftKey){$("#contentarea").find("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex=0], *[contenteditable]").last().focus()}else $("#ee-btn-close").focus();break;case 13:case 32:$(this).trigger("click");break;case 37:case 38:$(this).is("li:first-of-type")?$(this).siblings("li:last-of-type").trigger("click"):$(this).prev().trigger("click");break;case 39:case 40:$(this).is("li:last-of-type")?$(this).siblings("li:first-of-type").trigger("click"):$(this).next().trigger("click")}}),$(".ee-tabs").on("focus","li",function(e){$(this).siblings(".selected").focus()}),function(){var o,e,a=function(e,t){return function(){return e.apply(t,arguments)}};o=function(){function e(e){var t;t=null!=e?e:{},this.element=t.element,this.title=t.title,this.others=t.others,this.setInactive=a(this.setInactive,this),this.setActive=a(this.setActive,this),this.tab=$("<li tabindex='-1'>"+this.title+"</li>"),this.tab.click(this.setActive),$("ul.ee-tabs").append(this.tab)}return e.prototype.setActive=function(){var e,t,a;if(a=this.others,this.tab.hasClass("selected"))return!1;for(e=0,t=a.length;e<t;e++)a[e].setInactive();this.element.show(),this.tab.addClass("selected").focus()},e.prototype.setInactive=function(){return this.element.hide(),this.tab.removeClass("selected")},e}(),e=function(){var e,t,a,s,n,i;for(this.items=[],t=a=0,s=(n=$(".ee-btnarea")).length;a<s;t=++a)e=n[t],i=(e=$(e)).data("title"),this.items.push(new o({element:e,title:i,others:this.items}));1==$("ul.ee-tabs li").length?$("ul.ee-tabs li").remove():$("ul.ee-tabs li:first-child").addClass("selected"),$(".ee-btnarea").hide(),$(".ee-btnarea:nth-of-type(2)").show()},$(function(){return window.EETabGen=new e})}.call(this);var fadeOut,playFor,scrollBtnKilled=0;function MoreBtnController(e){var t=$(".scroll-indicator"),a=t.parent();setTimeout(function(){if(a[0].clientHeight<a[0].scrollHeight){if(0==scrollBtnKilled||2==scrollBtnKilled)t.removeClass("top hidden").addClass("more").attr("tabindex",0),scrollBtnKilled=0;else if(1==scrollBtnKilled){if(a.scrollTop()>=a[0].scrollHeight-a[0].clientHeight-3)return;$(".scroll-indicator").removeClass("more hidden").addClass("top").attr("tabindex",0),scrollBtnKilled=0}}else t.addClass("hidden").attr("tabindex",-1)},e)}function contextNav(e){var t,a,s,n,i,o,r,l,c;i=$(".scroll").parent(),0<(a=i.find(".context-"+e)).length&&(a.removeClass("context-active"),l=a.first().offset().top,r=i.scrollTop(),o=i.innerHeight()/2,n=(t=a.last().offset().top+a.last().height())-l,c=r+(l-i.innerHeight()/2+n/2),s=t<o+50&&o-50<t?250:1e3,i.animate({scrollTop:c},s,"swing"),setTimeout(function(){a.addClass("context-active")},s+750))}function initializeMediaControls(e){var o=e.querySelector(".media"),t=e.querySelector(".media-controls"),a=o.textTracks[0],s=e.querySelector(".video-custom-track"),n=e.querySelector(".video-custom-track-wrapper"),r=e.querySelector(".media-progress-container"),l=e.querySelector(".media-tooltip-seek"),c=e.querySelector(".media-hover"),i=e.querySelector(".media-progress"),d=e.querySelector(".media-seek"),u=e.querySelector(".video-hero-play"),p=e.querySelector(".media-btn-playpause"),h=e.querySelector(".media-btn-playpause-tooltip"),f=e.querySelector(".media-time-current"),m=e.querySelector(".media-time-duration"),b=e.querySelector(".media-btn-mute"),g=e.querySelector(".media-btn-mute-tooltip"),v=e.querySelector(".media-volume"),$=e.querySelector(".media-volume-progress"),w=v.value,C=e.querySelector(".video-btn-cc"),y=(e.querySelector(".video-btn-cc-tooltip"),e.querySelector(".video-btn-fs")),k=e.querySelector(".video-btn-fs-tooltip");function x(e){var t=Math.round(e);return Math.floor(e/60)+":"+(t=10<=(t=Math.floor(t%60))?t:"0"+t)}function S(){o.paused?(o.play(),p.classList.remove("icon-play"),p.classList.add("icon-pause"),u.classList.add("paused"),h.innerHTML="Pause"):(o.pause(),p.classList.remove("icon-pause"),p.classList.add("icon-play"),u.classList.remove("paused"),h.innerHTML="Play")}function I(){o.paused?(e.classList.remove("fadeout"),u.style.cursor="pointer",clearTimeout(M)):(e.classList.remove("fadeout"),u.style.cursor="pointer",clearTimeout(M),M=setTimeout(function(){e.classList.add("fadeout"),u.style.cursor="none"},3e3))}function P(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),B=!1,e.classList.remove("full-screen"),y.classList.remove("icon-fullscreen-exit"),y.classList.add("icon-fullscreen"),k.innerHTML="Full&nbsp;screen"}function T(){document.fullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||P()}o.controls=!1,t.classList.remove("hidden"),d.value=0,v.value=1;var z=setInterval(function(){0<o.readyState&&(d.setAttribute("max",10*o.duration),i.setAttribute("max",10*o.duration),m.innerHTML=x(o.duration),clearInterval(z))},200);if(d.addEventListener("input",function(){o.currentTime=d.value/10},!1),o.addEventListener("timeupdate",function(){o.currentTime>=i.value/10&&(i.value=10*o.currentTime),d.value=10*o.currentTime,f.innerHTML=x(o.currentTime)},!1),r.addEventListener("mouseover",function(e){c.classList.remove("hidden"),l.classList.remove("hidden")}),r.addEventListener("mousemove",function(e){var t=e.clientX,a=function(e){var t=0;if(e.offsetParent){for(;t+=e.offsetLeft,e=e.offsetParent;);return t}}(r),s=r.offsetWidth,n=(t-a)/s,i=x(o.duration*n);n<=1&&0<=n?(c.style.transform="scaleX("+n+")",l.style.left="calc("+100*n+"% - 0.15em)",l.innerHTML=i):n<0?(c.style.transform="scaleX(0)",l.style.left="0%"):(c.style.transform="scaleX(1)",l.style.left="100%")}),r.addEventListener("mouseout",function(e){c.classList.add("hidden"),l.classList.add("hidden")}),r.addEventListener("mousedown",function(e){r.classList.add("hover")}),r.addEventListener("mouseup",function(e){r.classList.remove("hover")}),p.addEventListener("click",S,!1),u.addEventListener("click",S,!1),b.addEventListener("click",function(e){o.muted&&0==w?(o.muted=!1,$.value=1,v.value=1,b.classList.remove("icon-volume-mute"),b.classList.add("icon-volume-up"),g.innerHTML="Mute"):o.muted&&0<=w&&w<.51?(o.muted=!1,v.value=w,$.value=w,b.classList.remove("icon-volume-mute"),b.classList.add("icon-volume-down"),g.innerHTML="Mute"):o.muted&&.51<=w?(o.muted=!1,v.value=w,$.value=w,b.classList.remove("icon-volume-mute"),b.classList.add("icon-volume-up"),g.innerHTML="Mute"):(o.muted=!0,v.value=0,$.value=0,b.classList.remove("icon-volume-down"),b.classList.remove("icon-volume-up"),b.classList.add("icon-volume-mute"),g.innerHTML="Unmute")}),v.addEventListener("input",function(){o.volume=this.value,$.value=this.value,w=this.value,0==this.value?(o.muted=!0,b.classList.remove("icon-volume-down"),b.classList.remove("icon-volume-up"),b.classList.add("icon-volume-mute"),g.innerHTML="Unmute"):(0<this.value&&this.value<.51?(o.muted=!1,b.classList.remove("icon-volume-mute"),b.classList.remove("icon-volume-up"),b.classList.add("icon-volume-down")):(o.muted=!1,b.classList.remove("icon-volume-mute"),b.classList.remove("icon-volume-down"),b.classList.add("icon-volume-up")),g.innerHTML="Mute")},!1),v.addEventListener("mousedown",function(e){v.classList.add("hover")}),v.addEventListener("mouseup",function(e){v.classList.remove("hover")}),o.textTracks.length){a.mode="hidden";var L=a.cues,E=0,A=function(){var e=this.text.replace(/(\r\n|\r|\n)/g,"&#160;<br/>&#160;");s.innerHTML="&#160;"+e+"&#160;",s.classList.remove("hidden")},q=function(){s.classList.add("hidden")};o.addEventListener("loadedmetadata",function(e){for(var t=0;t<L.length;t++){var a=L[t];a.onenter=A,a.onexit=q}}),C.style.display="inline-block",C.addEventListener("click",function(){E=0==E?(n.classList.remove("hidden"),C.classList.remove("icon-cc-off"),C.classList.add("icon-cc-on"),1):(n.classList.add("hidden"),C.classList.remove("icon-cc-on"),C.classList.add("icon-cc-off"),0)})}var M,B=!1;y.addEventListener("click",function(){B?P():(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(),B=!0,e.classList.add("full-screen"),y.classList.remove("icon-fullscreen"),y.classList.add("icon-fullscreen-exit"),k.innerHTML="Exit&nbsp;full&nbspscreen",u.focus(),I())},!1),document.addEventListener("fullscreenchange",function(e){T()}),document.addEventListener("webkitfullscreenchange",function(e){T()}),document.addEventListener("mozfullscreenchange",function(e){T()}),document.addEventListener("MSFullscreenChange",function(e){T()}),document.addEventListener("mousemove",function(e){I()}),document.addEventListener("click",function(e){I()}),document.addEventListener("keydown",function(e){I()}),document.addEventListener("touchmove",function(e){I()}),o.addEventListener("ended",function(){o.pause(),p.classList.remove("icon-pause"),p.classList.add("icon-play"),u.classList.remove("paused"),e.classList.remove("fadeout"),h.innerHTML="Play",o.currentTime=0})}function answerItem(e){var t,a=$(".childItem.selected").find(".response-area").length,s=e.parents(".response-area"),n=$(".itemTab li.selected"),i=parseInt(n.html());s.attr("answered",!0),$(".childItem.selected").find(".response-area").filter(function(){return"true"==$(this).attr("answered")}).length>=a&&(n.length&&(n.addClass("answered"),$(".list-review li:nth-of-type("+i+")").hide(),(t=$(".list-review li").filter(function(){return"list-item"==$(this).css("display")})).length<=1&&$("#review-questions-span").html("question"),0==t.length&&($(".review-unanswered").hide(),$(".review-answered").show())),updateState(".childItem.selected .btn-submit","enabled"),updateState(".childItem.selected .cta-message","enabled"),s.find(".cta-submit-wrapper .cta-message").attr("tabindex",-1))}function deAnswerItem(e){var t,a=$(".childItem.selected").find(".response-area").length,s=e.parents(".response-area"),n=$(".itemTab li.selected"),i=parseInt(n.html());s.attr("answered",!1),$(".childItem.selected").find(".response-area").filter(function(){return"true"==$(this).attr("answered")}).length<=a&&(n.length&&(n.removeClass("answered"),$(".list-review").find("li:nth-of-type("+i+")").show(),1<(t=$(".list-review li").filter(function(){return"list-item"==$(this).css("display")})).length&&$("#review-questions-span").html("questions"),0<t.length&&($(".review-answered").hide(),$(".review-unanswered").show())),updateState(".childItem.selected .btn-submit","disabled"),updateState(".childItem.selected .cta-message","disabled"))}function showTabTray(){if($(".itemTab").length){var e=parseInt($(".btn-tab-mover-wrapper:first-of-type").outerWidth()),t=parseInt($(window).width()),a=parseInt($(".itemTab li:first-of-type").offset().left),s=parseInt($(".itemTab li:last-of-type").offset().left)+parseInt($(".itemTab li:last-of-type").outerWidth(!0))-a;s<=t-5&&($(".enaepTabStrip").addClass("non-paginated"),$(".itemTab").css({"margin-left":0,transition:"margin 0s"})),t-5<s&&($(".enaepTabStrip").removeClass("non-paginated"),$(".itemTab").css({"margin-left":e,transition:"margin 0s"}))}}function changeBtnState(){if($(".itemTab").length){parseInt($(".itemTab").css("margin-left"));var e=parseInt($(".btn-tab-mover-wrapper:first-of-type").outerWidth()),t=parseInt($(".btn-tab-mover-wrapper:last-of-type").offset().left),a=parseInt($(".itemTab").offset().left),s=a+parseInt($(".itemTab").outerWidth());a<e-1&&updateState("#btn-tab-mover-left","enabled"),t+1<s&&updateState("#btn-tab-mover-right","enabled"),e-1<=a&&updateState("#btn-tab-mover-left","disabled"),s<=t+1&&updateState("#btn-tab-mover-right","disabled")}}function showActiveTab(){var e=parseInt($(".itemTab").css("margin-left")),t=parseInt($(".btn-tab-mover-wrapper:first-of-type").offset().left)+parseInt($(".btn-tab-mover-wrapper:first-of-type").outerWidth()),a=parseInt($(".btn-tab-mover-wrapper:last-of-type").offset().left),s=parseInt($(".itemTab li.selected").offset().left),n=s+parseInt($(".itemTab li.selected").outerWidth()),i=-(s-t),o=n-a;a<=n&&($(".itemTab").css({"margin-left":e-o,transition:"margin "+o/750+"s"}),setTimeout(function(){changeBtnState()},o+50)),s<=t&&($(".itemTab").css({"margin-left":e+i,transition:"margin "+i/750+"s"}),setTimeout(function(){changeBtnState()},i+50))}function updateEE(e){textArea=e.find("textarea").length,textInput=e.find("input[type=text]").length,0<textArea||0<textInput?updateState("#equation-btn","enabled"):updateState("#equation-btn","disabled")}function togglePoint(e){if(e.parents(".response-area").hasClass("delete-mode"))e.removeClass("point-placed").addClass("point-unplaced");else{if(e.hasClass("point-unplaced"))e.removeClass("point-unplaced").addClass("point-placed");else{if(e.hasClass("point-placed")&&e.hasClass("point-modal"))return void e.removeClass("point-new-state");if(e.hasClass("point-placeable")&&e.hasClass("point-new-state"))return;e.hasClass("point-placeable")&&e.hasClass("point-placed")&&e.removeClass("point-placed").addClass("point-unplaced")}e.siblings("point").removeClass("point-latest"),e.addClass("point-new-state point-latest")}}function fmAddCells(e,t,a){for(var s=0,n=e;s<n;s++){var i='<input type="checkbox" id="fm-unit-'+(t+s)+'" /><label for="fm-unit-'+(t+s)+'"></label>';a.append(i)}}function fmRemoveCells(e,t,a){var s=a.find("input"),n=a.find("label");if(0<e){t--;for(var i=0,o=e;i<o;i++){var r=t-e+i;n.eq(r).remove(),s.eq(r).remove()}}else a.empty()}function fmCreateCells(e,t){var a=360/e,s=e-Math.floor(e/4);t.empty();for(var n=0;n<s;n++){var i='<input type="checkbox" id="fm-unit-'+n+'" /><label for="fm-unit-'+n+'" style="transform: rotate(-'+n*a+'deg);"></label>';t.append(i)}t.append('<div class="fm-wedge-container"></div>');for(n=s;n<e;n++){i='<input type="checkbox" id="fm-unit-'+n+'" /><label for="fm-unit-'+n+'" style="transform: rotate(-'+n*a+'deg);"></label>';t.find(".fm-wedge-container").append(i)}e<4&&t.find("label").addClass("fm-wedge-"+e)}function fmBtnStateController(e){var t=e.find(".fm-model");if(t.hasClass("fm-grid")){var a=e.find(".fm-increment-col .ic-btn-minus"),s=e.find(".fm-increment-col .ic-btn-plus"),n=e.find(".fm-increment-row .ic-btn-minus"),i=e.find(".fm-increment-row .ic-btn-plus"),o=parseInt(t.attr("data-cols")),r=parseInt(t.attr("data-rows")),l=parseInt(t.attr("data-min-cols")),c=parseInt(t.attr("data-min-rows")),d=parseInt(t.attr("data-max-cols")),u=parseInt(t.attr("data-max-rows"));o<=l?a.attr("disabled",!0):l<o&&a.removeAttr("disabled"),d<=o?s.attr("disabled",!0):o<d&&s.removeAttr("disabled"),r<=c?n.attr("disabled",!0):c<r&&n.removeAttr("disabled"),u<=r?i.attr("disabled",!0):r<u&&i.removeAttr("disabled")}else if(t.hasClass("fm-circle")){var p=e.find(".fm-increment-section .ic-btn-minus"),h=e.find(".fm-increment-section .ic-btn-plus"),f=parseInt(t.attr("data-units")),m=parseInt(t.attr("data-min-units")),b=parseInt(t.attr("data-max-units"));f<=m?p.attr("disabled",!0):m<f&&p.removeAttr("disabled"),b<=f?h.attr("disabled",!0):f<b&&h.removeAttr("disabled")}}function fmModelController(e){var t=e.parents(".increment-control"),a=e.parents(".response-area-fm"),s=a.find(".fm-model"),n=s.find("input"),i=".ic-btn-minus",o=".ic-btn-plus",r=n.length+1;if(s.hasClass("fm-grid"))var l=s.attr("data-cols"),c=s.attr("data-rows");else var d=s.attr("data-units");n.prop("checked",!1),t.is(".fm-increment-col")?e.is(o)?(l++,fmAddCells(c,r,s)):e.is(i)&&(l--,fmRemoveCells(c,r,s)):t.is(".fm-increment-row")?e.is(o)?(c++,fmAddCells(l,r,s)):e.is(i)&&(c--,fmRemoveCells(l,r,s)):t.is(".fm-increment-section")&&(e.is(o)?fmCreateCells(++d,s):e.is(i)&&fmCreateCells(--d,s)),s.hasClass("fm-grid")?s.css({"grid-template-rows":"repeat("+c+", 1fr)","grid-template-columns":"repeat("+l+", 1fr)"}).attr("data-cols",l).attr("data-rows",c):s.hasClass("fm-circle")&&s.attr("data-units",d),fmBtnStateController(a)}function fmInitializeGrid(e,t,a){var s=t*a,n=e.parents(".response-area-fm");e.css({"grid-template-rows":"repeat("+a+", 1fr)","grid-template-columns":"repeat("+t+", 1fr)"}),fmRemoveCells(0,0,e),fmAddCells(s,1,e),fmBtnStateController(n)}function fmInitializeCircle(e,t){var a=e.parents(".response-area-fm");fmCreateCells(t,e),fmBtnStateController(a)}function fmResetBtnController(e,t,a){var s=e.find(".fm-btn-reset"),n=e.find(".fm-model");s.click(function(){n.hasClass("fm-grid")?(n.attr("data-cols",t).attr("data-rows",a),fmInitializeGrid(n,t,a)):n.hasClass("fm-circle")&&(n.attr("data-units",t),fmInitializeCircle(n,t))})}function calcListHeight(e){var t=e.find("li"),a=t.length;return t.outerHeight()*a+3}function setListHeight(e){e.children("ul").css({"max-height":calcListHeight(e)+"px"})}function dropDirection(e){var t=$(window).height(),a=e.children("span").outerHeight();t<=e.offset().top+a+calcListHeight(e)?e.addClass("drop-up"):e.removeClass("drop-up")}function closeDropdowns(){$(".inline-choice").removeClass("active"),$(".inline-choice").children("ul").css({"max-height":"0"}),$(".inline-choice").find("li").attr("tabindex",-1)}function toggleZoomPreview(e){var t=e.parents(".response-area"),a=e.closest(".nl-zoom-span"),s=a.siblings(".nl-zoom-span"),n=t.find(".nl-zoom-span"),i=t.find(".nl-zoom-view"),o="active";e.is(".nl-zoom-preview")||e.is(".nl-zoom-span")?s.removeClass(o):n.removeClass(o),e.is(".nl-zoom-span:first-of-type")?a.addClass(o):a.toggleClass(o),n.hasClass(o)?i.addClass(o):i.removeClass(o)}function tableToggleSelected(e){var t,a=e.parents(".response-area-selectable-table"),s=parseInt(a.data("minSelections"));e.hasClass("tts-active")||(e.toggleClass("selected"),t=a.find(".selected").length,"function"==typeof answerItem?((s==t||Number.isNaN(s))&&answerItem(e),t<s&&deAnswerItem(e)):console.warn("Missing tabs.js."))}function tableClearAnswer(e){var t=e.parents(".response-area-selectable-table"),a=t.find("tr"),s=t.find('input[type="checkbox"]');if(a.removeClass("selected"),s.prop("checked",!1),"function"==typeof deAnswerItem)return deAnswerItem($(this));console.warn("Missing tabs.js.")}function addSISUniqueIDs(){var e=1;$(".sis-selection").each(function(){$(this).attr("id","sis-selection-"+e),e++})}function setSIScolumns(e){var t=e.data("columns");0<t&&e.addClass("sis-col-"+t)}function setPlaceholders(e){var t=e.data("placeholders"),a=e.data("minSelections");if(1==t){e.removeClass("sis-no-placeholders");for(var s=0,n=a;s<n;s++)e.append('<div class="sis-selection-placeholder"></div>')}}function placeMediaSelections(o){var r=setInterval(function(){var e=o.parents(".media-container").find(".media");if(0<e.get(0).readyState){var t=o.data("startTime"),a=o.data("endTime"),s=1e3*parseInt(e.get(0).duration),n=t/s*100,i=a/s*100-n;o.css({left:n+"%",width:"calc("+i+"% - 2px)"}),clearInterval(r)}},200)}function evalSeeMore(e){var t=document.createElement("button");260<=e.clientHeight&&(e.classList.add("sis-text-overflow"),t.className="btn-see-more",e.append(t))}function modByMedia(e,t){var a,s=e.attr("title"),n=e.html(),i=e.attr("id").replace("sis-selection",""),o=$(".childItem.selected").find(".childStim").length,r=e.parents(".childStim").data("title");if(e.hasClass("sis-text-selection"))t.className="sis-selection-container sis-text",t.innerHTML=1<o?'<div class="sis-selection-header"><p>'+r+"</p></div><p>"+n+'</p><button class="btn-close"></button>':'<p><button class="btn-close"></button>'+n+"</p>";else if(e.hasClass("sis-media-selection")){a=e.parents(".media-container").find(".media").data("source"),t.className="sis-selection-container sis-media",t.innerHTML=1<o?'<div class="sis-selection-header"><p class="sis-selection-label">'+s+"</p><p>"+r+'</p></div><button class="btn-close"></button>':'<div class="sis-selection-header"><p class="sis-selection-label">'+s+'</p></div><button class="btn-close"></button>';var l=document.createElement("figure");l.className="media-container",l.innerHTML='<div class="media-wrapper"><video class="media" controls preload="metadata"><source src="'+a+i+'.mp4" type="video/mp4"><track src="../multimedia-controls/countdown_en.vtt" kind="subtitles" srclang="en" label="English"></video><button class="video-hero-play media-btn" aria-label="Play/Pause" tabindex="-1"></button><div class="video-custom-track-wrapper hidden"><span class="video-custom-track hidden"></span></div></div><div class="media-controls"><button type="button" class="media-btn icon-play media-btn-playpause" aria-label="Play/Pause"></button><span class="media-tooltip media-btn-playpause-tooltip">Play</span><span class="media-time-display"><span class="media-time-current">0:00</span><span>/</span><span class="media-time-duration">0:00</span></span><div class="media-progress-container-outer"><div class="slider-container media-progress-container"><div class="media-hover hidden"></div><progress class="media-progress" value="0"></progress><input type="range" class="media-seek" min="0" value="0" /></div><div class="media-tooltip media-tooltip-seek hidden">0:00</div></div><button type="button" class="media-btn icon-volume-up media-btn-mute"></button><div class="slider-container media-volume-container"><progress class="media-volume-progress" value="1" max="1"></progress><input type="range" class="media-volume" min="0" max="1" step="0.05" value="1" /></div><button type="button" class="media-btn icon-cc-off video-btn-cc" style="display: none;"></button><button type="button" class="media-btn icon-fullscreen video-btn-fs"></button><span class="media-tooltip media-btn-mute-tooltip">Mute</span><span class="media-tooltip video-btn-cc-tooltip">Closed&#160;captions</span><span class="media-tooltip video-btn-fs-tooltip">Full&#160;screen</span></div>',t.append(l),initializeMediaControls(l)}}function addSISselection(e){var t=$(".childItem.selected").find(".sis-response-area"),a=t.data("placeholders"),s=t.children("p"),n=t.children(".sis-selection-placeholder"),i=t.data("columns"),o=e.attr("id"),r=document.createElement("div");s.remove(),r.id=o+"-selected",1==a?(modByMedia(e,r),n.length?($(r).insertAfter(n.first()),n.first().remove()):t.append(r)):0==a&&(modByMedia(e,r),t.prepend(r)),1<i&&e.hasClass("sis-text-selection")&&evalSeeMore(r)}function removeSISselection(e,t){var a,s,n,i=$(".childItem.selected").find(".sis-response-area"),o=i.data("placeholders");"stim"==t?n=(s=e.closest(".sis-selection").attr("id"))+"-selected":"task"==t&&(s=(n=e.closest(".sis-selection-container").attr("id")).replace("-selected",""),$("#"+s).removeClass("selected")),(a=i.children("#"+n)).addClass("fadeout"),setTimeout(function(){a.remove(),1==o&&i.append('<div class="sis-selection-placeholder"></div>'),i.children(".sis-selection-container").length<1&&i.prepend("<p>Your choices will appear here.</p>"),a.hasClass("sis-text")?$(".sis-selection").first().focus():$(".sis-media-btn-primary").first().focus()},300)}function SISselectionController(e){var t=$(".sis-selection"),a=e.closest(".sis-selection.active"),s=$(".childItem.selected"),n=s.find(".sis-response-area"),i=s.find(".sis-selection-container"),o=i.length,r=n.data("maxSelections"),l=n.data("minSelections")-1,c=n.data("selectionUnitSingular"),d=n.data("selectionUnitPlural"),u="selected";if(a.hasClass(u))a.removeClass(u),removeSISselection(e,"stim"),"function"==typeof answerItem?deAnswerItem(i):console.warn("Missing tabs.js.");else if(n.hasClass("sis-single-select")){if(t.removeClass(u),i.remove(),a.addClass(u),addSISselection(e),"function"==typeof answerItem)return answerItem(i);console.warn("Missing tabs.js.")}else n.hasClass("sis-multiple-select")&&(o<r?(a.addClass(u),addSISselection(e)):r<=o&&(a.hasClass("sis-media-selection")?a.find(".sis-media-btn-primary").addClass("sis-selection-originator"):a.addClass("sis-selection-originator"),MaxSelectAlert(r,c,d)),o==r-1&&$(".btn-close").first().focus(),"function"==typeof answerItem?l<=o?answerItem(i):deAnswerItem(i):console.warn("Missing tabs.js."));MoreBtnController(300)}function closeMaxSelectAlert(){$(".sis-alert").addClass("hidden"),$(".sis-alert-close").attr("disabled",!0),$(".sis-selection-originator").focus(),$(".sis-selection-originator").removeClass("sis-selection-originator")}function MaxSelectAlert(e,t,a){var s=["one","two","three","four","five","six","seven","eight","nine","ten"][e-1],n=$(".sis-alert"),i=($(".sis-selection-originator"),$(".sis-alert-close")),o="opacity-transition";n.hasClass("hidden")?(n.removeClass(o),n.find("u").html(s),n.find(".sis-selection-unit-singular").html(t),n.find(".sis-selection-unit-plural").html(a),n.removeClass("hidden"),i.removeAttr("disabled"),i.focus(),fadeOut=setTimeout(function(){n.addClass(o),closeMaxSelectAlert()},6e3)):(clearTimeout(fadeOut),fadeOut=setTimeout(function(){n.addClass(o),closeMaxSelectAlert()},6e3),i.focus(),n.addClass("pulse"),setTimeout(function(){n.removeClass("pulse")},600))}function playVideoClip(e,t,a){var s=e.parents(".media-container"),n=s.find(".media"),i=s.find(".media-btn-playpause"),o=s.find(".video-hero-play"),r=s.find(".media-btn-playpause-tooltip"),l=".sis-media-selection",c=s.find(".sis-media-btn-play"),d=(t=e.parents(l).data("startTime"),a=e.parents(l).data("endTime"),e.closest(".sis-media-btn-play")),u="sis-media-playing",p="icon-play",h="icon-pause",f="paused",m=a-t;d.hasClass(u)?(n.get(0).pause(),d.removeClass(u),i.removeClass(h),i.addClass(p),o.removeClass(f),r.html("Play"),clearTimeout(playFor)):(n.get(0).currentTime=t/1e3,n.get(0).play(),c.removeClass(u),d.addClass(u),i.removeClass(p),i.addClass(h),o.addClass(f),r.html("Pause"),clearTimeout(playFor),playFor=setTimeout(function(){n.get(0).pause(),e.removeClass(u),i.removeClass(h),i.addClass(p),o.removeClass(f),r.html("Play")},m))}MoreBtnController(200),$(window).resize(function(){MoreBtnController(200)}),$(".scroll-indicator").click(function(e){var t=$(this),a=t.parent();t.hasClass("more")?(a.animate({scrollTop:a[0].scrollHeight},1e3),t.removeClass("more").addClass("top"),scrollBtnKilled=1):a.animate({scrollTop:0},300)}),$(".scroll-indicator").parent().on("scroll",function(){var e=$(this),t=$(".scroll-indicator");if(0==e.scrollTop()){if(!t.hasClass("top"))return;return t.addClass("hidden").attr("tabindex",-1),scrollBtnKilled=2}e.scrollTop()>=e[0].scrollHeight-e[0].clientHeight-3&&0==scrollBtnKilled&&(t.removeClass("more").addClass("top"),scrollBtnKilled=1)}),$(".btn-lbb").click(function(e){contextNav($(this).attr("id"))}),function(){var e=!!document.createElement("video").canPlayType,t=document.getElementsByTagName("video"),a=document.getElementsByTagName("audio");if(e&&t||e&&a)for(var s=document.querySelectorAll(".media-container"),n=0,i=s.length;n<i;n++)initializeMediaControls(s[n])}(),function(){var s,n,i,o,C=function(e,t){return function(){return e.apply(t,arguments)}};return s=function(){function e(e,t){var a,s,n,i,o,r,l,c,d,u,h,f,m,b,g,v,w;for(this.pageParent=e,this.myId=t,this.previous=C(this.previous,this),this.next=C(this.next,this),this.moveTo=C(this.moveTo,this),this.disablePage=C(this.disablePage,this),this.enablePage=C(this.enablePage,this),this._setNextBackButtonEnabled=C(this._setNextBackButtonEnabled,this),this.positionNavigator=C(this.positionNavigator,this),this.getPageScale=C(this.getPageScale,this),this.getName=C(this.getName,this),this.pages=this.pageParent.find(".card"),this.pageTops=function(){var e,t,a,s;for(a=this.pages,s=[],n=e=0,t=a.length;e<t;n=++e)p=a[n],s.push($(p).outerHeight()*n);return s}.call(this),this.pageContainer=$('<div class="page-container"></div>'),this.pageParent.append(this.pageContainer),this.pages.detach().appendTo(this.pageContainer),this.pageParent.append('<div class="page-mask"></div>'),r=parseInt(this.pageParent.css("margin-top")),this.pageParent.find(".page-mask").css("top",c+r+"px"),a=$('<div class="page-nav"></div>'),this.pageParent.append(a),a.append('<div class="page-btn-scrim"></div>'),a.append($('<button class="btn-page-previous" title="Previous Page. Goes back one page."></button>')),n=i=1,d=this.pages.length;1<=d?i<=d:d<=i;n=1<=d?++i:--i)a.append($("<button id='btn-page-"+n+"' class='btn-page-num' title='Page Number. Use these to move between pages.'>"+n+"</button>"));for(a.append($("<button class='btn-page-next' title='Next Page. Moves to the next page.'></button>")),this.disablePage(3),h=this,s=function(e){return!(h.turnDisabled||$(e.target).attr("disabled")||$(e.currentTarget).attr("disabled"))},$("#btn-enable-page").click((f=this,function(e){f.enablePage(3),$("#btn-enable-page").attr("disabled",!0)})),a.find(".btn-page-previous").click((m=this,function(e){if(s(e))return m.previous("nextBack")})),this.pageParent.find(".btn-page-next").click((b=this,function(e){if(s(e))return b.next("nextBack")})),l=function(t){return function(e){if(s(e))return g.moveTo(t,"pageButton")}},n=o=0,u=(g=this).pages.length;0<=u?o<u:u<o;n=0<=u?++o:--o)this.pageParent.find("#btn-page-"+(n+1)).click(l(n));return a.bind("keydown",(v=this,function(e){var t;switch(e.keyCode){case 37:case 38:if(e.preventDefault(),0===v.activePage)return;if(t=a.find("#btn-page-"+v.activePage),s({target:t[0]}))return v.previous("arrowKeys"),t.focus();break;case 39:case 40:if(e.preventDefault(),v.activePage===v.pages.length-1)return;if(t=a.find("#btn-page-"+(v.activePage+2)),s({target:t[0]}))return v.next("arrowKeys"),t.focus()}})),document.addEventListener("updatePageButtons",(w=this,function(e){var t,a,s;if("disable"==e.detail.state)return w.turnDisabled=!0,w.pageParent.find(".page-nav button").each(function(){if(!$(this).hasClass("page-active"))return $(this).attr("disabled",!0)});for(w.__disabledPages||(w.__disabledPages={}),w.turnDisabled=!1,a=t=1,s=w.pages.length;1<=s?t<=s:s<=t;a=1<=s?++t:--t)w.__disabledPages[a]||w.pageParent.find("#btn-page-"+a).removeAttr("disabled");return w._setNextBackButtonEnabled()})),c=$(this.pages[0]).outerHeight(),this.moveTo(0),this.positionNavigator()}return e.prototype.getName=function(){return"pageController"+this.myId},e.prototype.getPageScale=function(){var e;return(e=function(e){var t,a;return"none"===(a=window.getComputedStyle(e)).transform?1:("0px 0px"!==a.transformOrigin&&console.warn(e.nodeName+"#"+e.id+" has a transform-origin property of "+a.transformOrigin+". Values other than '0px 0px' may cause bugs in page button placement."),null!=(t=/matrix\((\d+\.?\d*),\s*0,\s*0,\s*(\d+\.?\d*),\s*0,\s*0\)/.exec(a.transform))&&t[1]===t[2]?parseFloat(t[1]):(console.warn(e.nodeName+"#"+e.id+" has a CSS transform that doesn't look like a 2D scale transform. This may cause bugs in page button placement."),1))})(this.pages[0])*e(this.pageContainer[0])},e.prototype.positionNavigator=function(){var e,t,a;return t=(e=this).pageParent.find(".page-nav"),a=$(e.pages[0]).outerHeight()*e.getPageScale()/2-t.outerHeight()/2+e.pageParent.offset().top,t.css("top",a+"px")},e.prototype._setNextBackButtonEnabled=function(){var e,t,a,s,n;for(e=t=1,s=this.pages.length;(1<=s?t<=s:s<=t)&&this.pageParent.find("#btn-page-"+e).attr("disabled");e=1<=s?++t:--t);for(this.activePage===e-1?(this.pageParent.find(".btn-page-previous").attr("disabled",!0),this.pageParent.find(".btn-page-next").focus()):this.turnDisabled||this.pageParent.find(".btn-page-previous").removeAttr("disabled"),e=a=n=this.pages.length;(n<=1?a<=1:1<=a)&&this.pageParent.find("#btn-page-"+e).attr("disabled");e=n<=1?++a:--a);return this.activePage===e-1?(this.pageParent.find(".btn-page-next").attr("disabled",!0),this.pageParent.find(".btn-page-previous").focus()):this.turnDisabled?void 0:this.pageParent.find(".btn-page-next").removeAttr("disabled")},e.prototype.enablePage=function(e){if(this.__disabledPages||(this.__disabledPages={}),this.__disabledPages[e]=!1,!this.turnDisabled)return e=parseInt(e,10),this.pageParent.find("#btn-page-"+e).removeClass("locked").removeAttr("disabled"),this._setNextBackButtonEnabled()},e.prototype.disablePage=function(e){var t,a,s,n,i,o,r;if(this.__disabledPages||(this.__disabledPages={}),this.__disabledPages[e]=!0,e=parseInt(e,10),this.pageParent.find("#btn-page-"+e).attr("disabled",!0).addClass("locked"),this.activePage===e-1){if(t=!(a=null),e<this.pages.length)for(a=s=i=e+1,o=this.pages.length;i<=o?s<=o:o<=s;a=i<=o?++s:--s)if(!this.__disabledPages[a]){this.moveTo(a-1,"auto",!1),t=!1;break}if(t&&1<e)for(a=n=r=e-1;r<=1?n<=1:1<=n;a=r<=1?++n:--n)if(!this.__disabledPages[a]){this.moveTo(a-1,"auto",!1);break}}return this._setNextBackButtonEnabled()},e.prototype.moveTo=function(n,e,t){var a,s,i,o,r,l;if(0<=n&&n<this.pages.length&&n!==this.activePage)return i=null!=this.activePage?this.myTabTitle+"page-"+(this.activePage+1):null,s=this.myTabTitle+"page-"+(n+1),null!=this.activePage&&document.dispatchEvent(new CustomEvent("beforePageTurn",{detail:{from:i,to:s}})),this.pages.css("visibility","visible"),this.pageParent.find(".btn-page-num").removeClass("page-active").removeAttr("tabindex"),this.pageParent.find("#btn-page-"+(n+1)).addClass("page-active").attr("tabindex",-1),a=null!=this.activePage?n>this.activePage?n-this.activePage:this.activePage-n:0,this.activePage=n,this._setNextBackButtonEnabled(),r=1===a?.25:a/1.5*.25,"auto"===e&&(r*=2),t&&(r=0),this.pageContainer.css({"transition-duration":r+"s","margin-top":"-"+this.pageTops[n]+"px"}),l=this,setTimeout(function(){var e,t,a,s;for(a=l.pages,s=[],n=e=0,t=a.length;e<t;n=++e)o=a[n],n!==l.activePage?s.push($(o).css("visibility","hidden")):s.push(void 0);return s},1e3*r+500),setTimeout(function(){return document.dispatchEvent(new CustomEvent("afterPageTurn",{detail:{from:i,to:s}}))},1e3*r)},e.prototype.next=function(e){var t,a,s,n;if(!(this.activePage>this.pages.length-1))for(this.__disabledPages||(this.__disabledPages={}),t=a=s=this.activePage+2,n=this.pages.length;s<=n?a<=n:n<=a;t=s<=n?++a:--a)if(!this.__disabledPages[t])return void this.moveTo(t-1,e)},e.prototype.previous=function(e){var t,a,s;if(0<this.activePage)for(this.__disabledPages||(this.__disabledPages={}),t=a=s=this.activePage;s<=1?a<=1:1<=a;t=s<=1?++a:--a)if(!this.__disabledPages[t])return void this.moveTo(t-1,e)},e}(),o=$(".card").parent(),function(){var e,t,a;for(a=[],n=e=0,t=o.length;e<t;n=++e)i=o[n],a.push(new s($(i),n));return a}()}.call(this),function(){var s,n,i,o,w=function(e,t){return function(){return e.apply(t,arguments)}};return s=function(){function e(e,t){var a,s,n,i,o,r,l,c,d,u,h,f,m,b,g,v;for(this.pageParent=e,this.myId=t,this.previous=w(this.previous,this),this.next=w(this.next,this),this.moveTo=w(this.moveTo,this),this.disablePage=w(this.disablePage,this),this.enablePage=w(this.enablePage,this),this._setNextBackButtonEnabled=w(this._setNextBackButtonEnabled,this),this.positionNavigator=w(this.positionNavigator,this),this.getPageScale=w(this.getPageScale,this),this.getName=w(this.getName,this),this.pages=this.pageParent.find(".card"),this.pageTops=function(){var e,t,a,s;for(a=this.pages,s=[],n=e=0,t=a.length;e<t;n=++e)p=a[n],s.push($(p).outerHeight()*n);return s}.call(this),this.pageContainer=$('<div class="page-container"></div>'),this.pageParent.append(this.pageContainer),this.pages.detach().appendTo(this.pageContainer),this.pageParent.append('<div class="page-mask"></div>'),r=parseInt(this.pageParent.css("margin-top")),this.pageParent.find(".page-mask").css("top",c+r+"px"),a=$('<div class="page-nav"></div>'),this.pageParent.append(a),a.append('<div class="page-btn-scrim"></div>'),a.append($('<button class="btn-page-previous" title="Previous Page. Goes back one page."></button>')),n=i=1,d=this.pages.length;1<=d?i<=d:d<=i;n=1<=d?++i:--i)a.append($("<button id='btn-page-"+n+"' class='btn-page-num' title='Page Number. Use these to move between pages.'>"+n+"</button>"));for(a.append($("<button class='btn-page-next' title='Next Page. Moves to the next page.'></button>")),h=this,s=function(e){return!(h.turnDisabled||$(e.target).attr("disabled")||$(e.currentTarget).attr("disabled"))},a.find(".btn-page-previous").click((f=this,function(e){if(s(e))return f.previous("nextBack")})),this.pageParent.find(".btn-page-next").click((m=this,function(e){if(s(e))return m.next("nextBack")})),l=function(t){return function(e){if(s(e))return b.moveTo(t,"pageButton")}},n=o=0,u=(b=this).pages.length;0<=u?o<u:u<o;n=0<=u?++o:--o)this.pageParent.find("#btn-page-"+(n+1)).click(l(n));return a.bind("keydown",(g=this,function(e){var t;switch(e.keyCode){case 37:case 38:if(e.preventDefault(),0===g.activePage)return;if(t=a.find("#btn-page-"+g.activePage),s({target:t[0]}))return g.previous("arrowKeys"),t.focus();break;case 39:case 40:if(e.preventDefault(),g.activePage===g.pages.length-1)return;if(t=a.find("#btn-page-"+(g.activePage+2)),s({target:t[0]}))return g.next("arrowKeys"),t.focus()}})),document.addEventListener("updatePageButtons",(v=this,function(e){var t,a,s;if("disable"==e.detail.state)return v.turnDisabled=!0,v.pageParent.find(".page-nav button").each(function(){if(!$(this).hasClass("page-active"))return $(this).attr("disabled",!0)});for(v.__disabledPages||(v.__disabledPages={}),v.turnDisabled=!1,a=t=1,s=v.pages.length;1<=s?t<=s:s<=t;a=1<=s?++t:--t)v.__disabledPages[a]||v.pageParent.find("#btn-page-"+a).removeAttr("disabled");return v._setNextBackButtonEnabled()})),c=$(this.pages[0]).outerHeight(),this.moveTo(0),this.positionNavigator()}return e.prototype.getName=function(){return"pageController"+this.myId},e.prototype.getPageScale=function(){var e;return(e=function(e){var t,a;return"none"===(a=window.getComputedStyle(e)).transform?1:("0px 0px"!==a.transformOrigin&&console.warn(e.nodeName+"#"+e.id+" has a transform-origin property of "+a.transformOrigin+". Values other than '0px 0px' may cause bugs in page button placement."),null!=(t=/matrix\((\d+\.?\d*),\s*0,\s*0,\s*(\d+\.?\d*),\s*0,\s*0\)/.exec(a.transform))&&t[1]===t[2]?parseFloat(t[1]):(console.warn(e.nodeName+"#"+e.id+" has a CSS transform that doesn't look like a 2D scale transform. This may cause bugs in page button placement."),1))})(this.pages[0])*e(this.pageContainer[0])},e.prototype.positionNavigator=function(){var e,t,a;return t=(e=this).pageParent.find(".page-nav"),a=$(e.pages[0]).outerHeight()*e.getPageScale()/2-t.outerHeight()/2+e.pageParent.offset().top,t.css("top",a+"px")},e.prototype._setNextBackButtonEnabled=function(){var e,t,a,s,n;for(e=t=1,s=this.pages.length;(1<=s?t<=s:s<=t)&&this.pageParent.find("#btn-page-"+e).attr("disabled");e=1<=s?++t:--t);for(this.activePage===e-1?(this.pageParent.find(".btn-page-previous").attr("disabled",!0),this.pageParent.find(".btn-page-next").focus()):this.turnDisabled||this.pageParent.find(".btn-page-previous").removeAttr("disabled"),e=a=n=this.pages.length;(n<=1?a<=1:1<=a)&&this.pageParent.find("#btn-page-"+e).attr("disabled");e=n<=1?++a:--a);return this.activePage===e-1?(this.pageParent.find(".btn-page-next").attr("disabled",!0),this.pageParent.find(".btn-page-previous").focus()):this.turnDisabled?void 0:this.pageParent.find(".btn-page-next").removeAttr("disabled")},e.prototype.enablePage=function(e){if(this.__disabledPages||(this.__disabledPages={}),this.__disabledPages[e]=!1,!this.turnDisabled)return e=parseInt(e,10),this.pageParent.find("#btn-page-"+e).removeClass("locked").removeAttr("disabled"),this._setNextBackButtonEnabled()},e.prototype.disablePage=function(e){var t,a,s,n,i,o,r;if(this.__disabledPages||(this.__disabledPages={}),this.__disabledPages[e]=!0,e=parseInt(e,10),this.pageParent.find("#btn-page-"+e).attr("disabled",!0).addClass("locked"),this.activePage===e-1){if(t=!(a=null),e<this.pages.length)for(a=s=i=e+1,o=this.pages.length;i<=o?s<=o:o<=s;a=i<=o?++s:--s)if(!this.__disabledPages[a]){this.moveTo(a-1,"auto",!1),t=!1;break}if(t&&1<e)for(a=n=r=e-1;r<=1?n<=1:1<=n;a=r<=1?++n:--n)if(!this.__disabledPages[a]){this.moveTo(a-1,"auto",!1);break}}return this._setNextBackButtonEnabled()},e.prototype.moveTo=function(n,e,t){var a,s,i,o,r,l;if(0<=n&&n<this.pages.length&&n!==this.activePage)return i=null!=this.activePage?this.myTabTitle+"page-"+(this.activePage+1):null,s=this.myTabTitle+"page-"+(n+1),null!=this.activePage&&document.dispatchEvent(new CustomEvent("beforePageTurn",{detail:{from:i,to:s}})),this.pages.css("visibility","visible"),this.pageParent.find(".btn-page-num").removeClass("page-active").removeAttr("tabindex"),this.pageParent.find("#btn-page-"+(n+1)).addClass("page-active").attr("tabindex",-1),a=null!=this.activePage?n>this.activePage?n-this.activePage:this.activePage-n:0,this.activePage=n,this._setNextBackButtonEnabled(),r=1===a?.25:a/1.5*.25,"auto"===e&&(r*=2),t&&(r=0),this.pageContainer.css({"transition-duration":r+"s","margin-top":"-"+this.pageTops[n]+"px"}),l=this,setTimeout(function(){var e,t,a,s;for(a=l.pages,s=[],n=e=0,t=a.length;e<t;n=++e)o=a[n],n!==l.activePage?s.push($(o).css("visibility","hidden")):s.push(void 0);return s},1e3*r+500),setTimeout(function(){return document.dispatchEvent(new CustomEvent("afterPageTurn",{detail:{from:i,to:s}}))},1e3*r)},e.prototype.next=function(e){var t,a,s,n;if(!(this.activePage>this.pages.length-1))for(this.__disabledPages||(this.__disabledPages={}),t=a=s=this.activePage+2,n=this.pages.length;s<=n?a<=n:n<=a;t=s<=n?++a:--a)if(!this.__disabledPages[t])return void this.moveTo(t-1,e)},e.prototype.previous=function(e){var t,a,s;if(0<this.activePage)for(this.__disabledPages||(this.__disabledPages={}),t=a=s=this.activePage;s<=1?a<=1:1<=a;t=s<=1?++a:--a)if(!this.__disabledPages[t])return void this.moveTo(t-1,e)},e}(),o=$(".card").parent(),function(){var e,t,a;for(a=[],n=e=0,t=o.length;e<t;n=++e)i=o[n],a.push(new s($(i),n));return a}()}.call(this),function(){var o,e,r,t;bind=function(e,t){return function(){return e.apply(t,arguments)}},indexOf=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1},o=function(){function e(e){var t,a,s;t=null!=e?e:{},this.element=t.element,this.title=t.title,this.listitem=t.listitem,this.others=t.others,this.setInactive=bind(this.setInactive,this),this.setActive=bind(this.setActive,this),this.tab=$("<li class='item'>"+this.title+"</li>"),this.tab.click(this.setActive),$("ul.itemTab").append(this.tab),this.listitem=$("<li>Question "+this.title+"</li>"),$(".list-review").append(this.listitem),"function"==typeof scratchwork?(s=(a=this.element.outerHeight()+24)/24,this.element.append('<canvas class="scratchwork-canvas" id="sw'+this.title+'" width="1416" height="'+a+'" style="height: '+s+'em;"></canvas>'),$(".scratchwork-canvas").each(function(e){scratchwork("sw"+(e+1),"initialize")})):console.warn("Missing scratchwork.js.")}return e.prototype.setActive=function(){var e,t,a;if(a=this.others,this.tab.hasClass("selected"))return!1;for(e=0,t=a.length;e<t;e++)a[e].setInactive();this.element.parent(".content-container").show(),$(".contentarea-inner").animate({scrollTop:0},300),this.element.show(),this.tab.addClass("selected"),this.element.addClass("selected"),this.tab.prev().length?this.tab.next().length?updateState("nav","middle"):updateState("nav","end"):updateState("nav","start"),this.tab.parents(".enaepTabStrip").hasClass("non-paginated")||showActiveTab(),"function"==typeof MoreBtnController?MoreBtnController(300):console.warn("Missing scroll-indicator.js."),this.tab.is(":last-of-type")?updateState("#scratchwork-btn","disabled"):updateState("#scratchwork-btn","enabled"),updateState("ee","off"),updateState("tts","off"),updateEE(this.element)},e.prototype.setInactive=function(){return this.element.parent(".content-container").hide(),this.element.hide(),this.element.removeClass("selected"),this.tab.removeClass("selected")},e}(),e=function(){var e,t,a,s,n,i;for(this.items=[],t=a=0,s=(n=$(".childItem")).length;a<s;t=++a)e=n[t],e=$(e),i=t+1,this.items.push(new o({element:e,title:i,others:this.items}));$("ul.itemTab li:first-child").addClass("selected"),$("ul.itemTab li:last-child").html("Review"),$(".content-container").hide(),$(".content-container:first-of-type").find(".childItem").addBack().show(),$(".content-container:first-of-type").find(".childItem").addBack().addClass("selected"),updateEE($(".content-container:first-of-type")),$(".list-review li:last-of-type").remove()},r=function(){function e(e){var t;t=null!=e?e:{},this.element=t.element,this.title=t.title,this.listitem=t.listitem,this.others=t.others,this.setInactive=bind(this.setInactive,this),this.setActive=bind(this.setActive,this),this.tab=$("<li class='stim'>"+this.title+"</li>"),this.tab.click(this.setActive),$("ul.stimTab").append(this.tab)}return e.prototype.setActive=function(){var e,t,a;if(a=this.others,this.tab.hasClass("selected"))return!1;for(e=0,t=a.length;e<t;e++)a[e].setInactive();$(".stim-container").fadeOut(0).delay(250).fadeIn(200),this.element.show(),this.tab.addClass("selected"),this.element.addClass("selected")},e.prototype.setInactive=function(){return this.element.hide(),this.element.removeClass("selected"),this.tab.removeClass("selected")},e}(),t=function(){var e,t,a,s,n,i;for(this.items=[],t=a=0,s=(n=$(".childStim")).length;a<s;t=++a)e=n[t],e=$(e),i=$(e).data("title"),this.items.push(new r({element:e,title:i,others:this.items}));$("ul.stimTab li:first-child").addClass("selected"),$(".childStim").hide(),$(".childStim").eq(0).show(),$(".childStim").eq(0).addClass("selected")},$(function(){return window.ItemTabGen=new e,window.StimTabGen=new t})}.call(this),$(document).ready(function(){showTabTray(),changeBtnState(),$(window).resize(function(){showTabTray(),changeBtnState()}),$("#btn-tab-mover-left").click(function(e){var t=parseInt($(".itemTab").css("margin-left")),a=parseInt($(".btn-tab-mover-wrapper:first-of-type").offset().left),s=parseInt($(".btn-tab-mover-wrapper:first-of-type").outerWidth()),n=a+s,i=parseInt($(".btn-tab-mover-wrapper:last-of-type").offset().left)-n,o=-(parseInt($(".itemTab").offset().left)-n),r=i%parseInt($(".itemTab li:first-of-type").outerWidth());o<i?($(".itemTab").css({"margin-left":s,transition:"margin "+o/1e3+"s"}),updateState("#btn-tab-mover-left","disabled")):($(".itemTab").css({"margin-left":t+i-r,transition:"margin "+i/1e3+"s"}),updateState("#btn-tab-mover-right","enabled")),setTimeout(function(){changeBtnState()},i)}),$("#btn-tab-mover-right").click(function(e){var t=parseInt($(".itemTab").css("margin-left")),a=parseInt($(".btn-tab-mover-wrapper:last-of-type").offset().left),s=a-(parseInt($(".btn-tab-mover-wrapper:first-of-type").offset().left)+parseInt($(".btn-tab-mover-wrapper:first-of-type").outerWidth())),n=parseInt($(".itemTab").offset().left)+parseInt($(".itemTab").outerWidth())-a,i=s%parseInt($(".itemTab li:first-of-type").outerWidth());n<s?($(".itemTab").css({"margin-left":t-n,transition:"margin "+n/1e3+"s"}),updateState("#btn-tab-mover-right","disabled")):$(".itemTab").css({"margin-left":t-s+i,transition:"margin "+s/1e3+"s"}),setTimeout(function(){changeBtnState()},s)}),$("#back-btn").click(function(){$(".itemTab li.selected").prev().trigger("click")}),$("#next-btn").click(function(){$(".itemTab li.selected").next().trigger("click")})}),$(".point-placeable, .point-modal").click(function(){target=$(this),togglePoint(target)}),$(".point-placeable, .point-modal").keydown(function(e){var t=e.keyCode?e.keyCode:e.which,a=$(this),s=$(".point").index(this),n=(a.parents(".response-area-number-line").find(".btn").eq(0),a.parents(".number-line")),i=n.find(".point"),o=i.eq(s-1),r=i.eq(s+1),l=i.first(),c=i.last();switch(t){case 9:a.removeClass("active");break;case 13:case 32:e.preventDefault(),a.hasClass("point-placed")&&a.hasClass("point-modal")&&(a.siblings(".point").removeClass("active"),a.toggleClass("active")),togglePoint(a);break;case 37:case 38:n.length&&(e.preventDefault(),o.focus());break;case 39:case 40:n.length&&a.is(c)?(e.preventDefault(),l.focus()):n.length&&!a.is(c)&&(e.preventDefault(),r.focus())}}),$(".number-line .point-placeable").focus(function(){$(this).siblings(".point-placeable").attr("tabindex",-1)}),$(".point-placeable, .point-modal").mouseleave(function(){$(this).removeClass("point-new-state")}),$(".point-placeable, point-modal").blur(function(){$(this).removeClass("point-new-state"),$(".point").removeAttr("tabindex")}),$(".btn-point-delete").click(function(){$(this).parents(".response-area").toggleClass("delete-mode")}),$(".btn-point-delete").keydown(function(e){var t=e.keyCode?e.keyCode:e.which,a=$(this).parents(".response-area"),s=a.find(".point"),n="delete-mode";switch(t){case 13:case 32:e.preventDefault(),a.toggleClass(n),a.hasClass(n)&&s.eq(0).addClass("focus-tabbed").focus()}}),$(document).keydown(function(e){switch(e.keyCode?e.keyCode:e.which){case 27:$(".response-area").removeClass("delete-mode")}}),$(".handle-size").hover(function(){$(this).prev(".bg-bar").toggleClass("hover")}),$(".handle-size").mousedown(function(){$(this).prev(".bg-bar").addClass("active")}),$(document).mouseup(function(){$(".bg-bar").removeClass("active")}),$(".handle-size").on("touchstart",function(){$(this).prev(".bg-bar").addClass("active")}),$(document).on("touchend",function(){$(".bg-bar").removeClass("active")}),$(document).on("keyup",".handle-size",function(e){var t=e.keyCode?e.keyCode:e.which,a=$(this),s=a.prev(".bg-bar");if(a.is(":focus"))switch(t){case 9:s.addClass("active")}}),$(document).on("blur",".handle-size",function(e){$(this).prev(".bg-bar").removeClass("active")}),$(".handle-size").keydown(function(e){var t=e.keyCode?e.keyCode:e.which,a=$(this),s=a.prev(".bg-bar");switch(t){case 38:case 40:e.preventDefault(),a.addClass("active"),s.addClass("active")}}),$(".handle-size").keyup(function(){$(this).removeClass("active")}),$(".handle-size").click(function(){$(this).removeClass("active")}),$(".bw-box, .bw-whisker").hover(function(){$(this).siblings(".bw-box, .bw-whisker").toggleClass("hover")}),$(".bw-box, .bw-whisker").mousedown(function(){$(this).siblings(".bw-box, .bw-whisker").addClass("active")}),$(document).mouseup(function(){$(".bw-whisker, .bw-box").removeClass("active")}),$(".bw-box, .bw-whisker").on("touchstart",function(){$(this).siblings(".bw-box, .bw-whisker").addClass("active")}),$(document).on("touchend",function(){$(".bw-whisker, .bw-box").removeClass("active hover")}),$(".fm-grid").each(function(e){var t=$(this),a=t.parents(".response-area-fm"),s=t.attr("data-cols"),n=t.attr("data-rows");fmInitializeGrid(t,s,n),fmResetBtnController(a,s,n)}),$(".fm-circle").each(function(e){var t=$(this),a=t.parents(".response-area-fm"),s=t.attr("data-units");fmInitializeCircle(t,s),fmResetBtnController(a,s)}),$(".response-area-fm .ic-btn-plus, .response-area-fm .ic-btn-minus").click(function(){fmModelController($(this))}),$(document).on("change",".fm-model input",function(){var e=$(this),t=e.parents("response-area-fm"),a=e.next("label"),s="fm-initial-state";t.find("label").removeClass(s),a.addClass(s)}),$(document).on("mouseout",".fm-model label",function(){$(this).removeClass("fm-initial-state")}),$(document).on("blur",".fm-model input",function(){$(this).next("label").removeClass("fm-initial-state"),$(".fm-model input").removeAttr("tabindex")}),$(document).on("focus",".fm-model input",function(){$(this).siblings("input").attr("tabindex",-1),$(this).siblings().find("input").attr("tabindex",-1),$(this).parents(".fm-wedge-container").siblings("input").attr("tabindex",-1)}),$(document).on("keydown",".fm-grid input",function(e){var t=e.keyCode?e.keyCode:e.which,a=$(this),s=$("input").index(this),n=(a.parents(".response-area-fm"),a.parents(".fm-grid")),i=parseInt(n.attr("data-cols")),o=n.find("input"),r=o.eq(s-i),l=o.eq(s+i),c=o.eq(s-1),d=o.eq(s+1),u=o.first(),p=o.last();switch(t){case 13:a.trigger("click");break;case 38:e.preventDefault(),r.focus();break;case 37:e.preventDefault(),c.focus();break;case 39:e.preventDefault(),a.is(p)?u.focus():d.focus();break;case 40:e.preventDefault(),l.focus()}}),$(document).on("keydown",".fm-circle input",function(e){var t=e.keyCode?e.keyCode:e.which,a=$(this),s=$("input").index(this),n=(a.parents(".response-area-fm"),a.parents(".fm-circle").find("input")),i=n.eq(s-1),o=n.eq(s+1),r=n.first(),l=n.last();switch(t){case 13:a.trigger("click");break;case 37:case 38:e.preventDefault(),i.focus();break;case 39:case 40:e.preventDefault(),a.is(l)?r.focus():o.focus()}}),$(".asymptote-handle").mousedown(function(){$(this).siblings(".asymptote").addClass("active")}),$(".asymptote").mousedown(function(){$(this).siblings(".asymptote-handle").addClass("active")}),$(document).mouseup(function(){$(".asymptote").removeClass("active"),$(".asymptote-handle").removeClass("active")}),$(".asymptote-handle").on("touchstart",function(){$(this).siblings(".asymptote").addClass("active")}),$(".asymptote").on("touchstart",function(){$(this).siblings(".asymptote-handle").addClass("active")}),$(document).on("touchend",function(){$(".asymptote").removeClass("active"),$(".asymptote-handle").removeClass("active")}),addUniqueID($(".grid"),"grid-"),$(".grid").each(function(){var e=$(this),t=e.attr("id");addUniqueID(e.find("tr"),t+"-")}),$(".grid tr").each(function(){var e=$(this),t=e.find("input"),a=e.attr("id");t.attr("name",a)}),function(){var e;e=function(){var e,t,a,s,n,i,o,r,l,c,d,u,p,h,f,m,b,g;for(t=0,s=(h=$(".response-area-grid")).length;t<s;t++)u=h[t],e=function(e){return function(){if(e.find("input").prop("checked",!1),e.find("table.grid tr").removeClass("grid-row-selected"),"function"==typeof deAnswerItem)return deAnswerItem($(this));console.warn("Missing tabs.js.")}},$(u).find(".btn-clear-answer").click(e($(u)));for(a=0,n=(f=$("table.grid.grid-multiple-select input")).length;a<n;a++)u=f[a],e=function(e){return function(){g=e.parents("td").siblings("td").find("input:checked").length,e.focus(),0==e.prop("checked")?(e.prop("checked",!0),e.parents("tr").addClass("grid-row-selected")):(e.prop("checked",!1),g<=0&&e.parents("tr").removeClass("grid-row-selected")),d=e.parents("table.grid").find(".grid-row-selected").length,c=e.parents("table.grid").find("tr").length-1,"function"==typeof answerItem?(c==d&&answerItem(e),d<c&&deAnswerItem(e)):console.warn("Missing tabs.js.")}},$(u).parents("td").click(e($(u)));for(r=0,i=(m=$("table.grid.grid-single-select tr")).length;r<i;r++)for(p=m[r],l=0,o=(b=$(p).find("input")).length;l<o;l++)u=b[l],e=function(e){return function(){e.parents("tr").addClass("grid-row-selected"),e.prop("checked",!0),e.focus(),e.parents("td").siblings("td").find("input").prop("checked",!1),d=e.parents("table.grid").find(".grid-row-selected").length,c=e.parents("table.grid").find("tr").length-1,"function"==typeof answerItem?(c==d&&answerItem(e),d<c&&deAnswerItem(e)):console.warn("Missing tabs.js.")}},$(u).parents("td").click(e($(u)))},$(function(){return window.GridController=new e})}.call(this),$("table.grid-multiple-select input").keydown(function(e){var t=$(this),a=(t.parents(".response-area-grid").find(".btn-clear-answer"),t.parents("table")),s=a.find("tr:first-of-type"),n=a.find("tr:last-of-type"),i=t.parents("td"),o=t.parents("tr"),r=o.prev(),l=o.next();switch(e.which){case 13:case 32:e.preventDefault(),i.trigger("click");break;case 37:e.preventDefault(),i.is("td:first-of-type")?i.siblings("td:last-of-type").find("input").focus():i.prev().find("input").focus();break;case 38:e.preventDefault();var c=i.index()-1;o.is("tr:first-of-type")?n.find("td").eq(c).find("input").focus():r.find("td").eq(c).find("input").focus();break;case 39:e.preventDefault(),i.is("td:last-of-type")?i.siblings("td:first-of-type").find("input").focus():i.next().find("input").focus();break;case 40:e.preventDefault();c=i.index()-1;o.is("tr:last-of-type")?s.find("td").eq(c).find("input").focus():l.find("td").eq(c).find("input").focus()}}),$(document).click(function(e){var t=$(e.target).closest(".inline-choice");t.length&&!t.hasClass("active")?(closeDropdowns(),setListHeight(t),dropDirection(t),t.addClass("active"),t.find("li").attr("tabindex",0)):closeDropdowns()}),$(".response-area-ic .btn-clear-answer").click(function(){var e=$(this).parents(".response-area-ic");e.find(".inline-choice").children("span").html(""),e.find(".inline-choice li").removeClass("selected"),e.find(".inline-choice li:first-of-type").addClass("selected"),"function"==typeof deAnswerItem?deAnswerItem($(this)):console.warn("Missing tabs.js.")}),$(".inline-choice li").click(function(){if($(this).siblings().removeClass("selected"),$(this).addClass("selected"),value=$(this).html(),$(this).parents(".inline-choice").children("span").html(value).focus(),"function"==typeof answerItem){value.length?$(this).parents(".inline-choice").attr("answered",!0):$(this).parents(".inline-choice").attr("answered",!1);var e=$(this).parents(".response-area-ic").find(".inline-choice").length;$(this).parents(".response-area-ic").find(".inline-choice").filter(function(){return"true"==$(this).attr("answered")}).length>=e?answerItem($(this)):deAnswerItem($(this))}else console.warn("Missing tabs.js.")}),$(".inline-choice span").keydown(function(e){switch(e.which){case 13:case 32:e.preventDefault(),$(this).trigger("click"),$(this).siblings("ul").find(".selected").focus()}}),$(".inline-choice li").keydown(function(e){switch(e.preventDefault(),e.which){case 9:case 27:closeDropdowns(),$(this).parents(".inline-choice").children("span").focus();break;case 13:case 32:$(this).trigger("click");break;case 33:case 36:$(this).siblings("li:first-of-type").focus();break;case 34:case 35:$(this).siblings("li:last-of-type").focus();break;case 38:$(this).prev().focus();break;case 40:$(this).next().focus();break;default:return!1}}),$(function(){$(".match-option").draggable({revert:function(e){if(!e)return $(this).delay(400).queue(function(e){$(this).removeClass("hidden"),e()}),"invalid"},revertDuration:400,containment:".childItem.selected .response-area-match",helper:"clone",scroll:!0,start:function(){var e=$(this).data("maxUses");1==e&&$(this).addClass("hidden")}}),$(".match-drop-target").droppable({hoverClass:"draghover",activeClass:"dragactive",accept:function(e){if(e.data("matchGroup")===$(this).data("matchGroup"))return"true"},drop:function(e,t){var a,s,n,i,o,r,l,c,d;c=$(this).data("minSelections"),r=$(this).data("maxSelections"),a=$(this).data("matchGroup"),o=0,d=$(this).parents(".response-area-match").find(".match-drop-target").length,"1"==r&&$(this).html().length&&(i=$(this).find(".match-option").text(),$(this).parents(".response-area-match").find(".match-source-tray").find('.match-option:contains("'+i+'")').removeClass("hidden"),$(this).empty()),$("<div class='match-option match-option-text' data-match-group="+a+"></div>").html(t.draggable.html()).appendTo(this),r<=(s=$(this).find(".match-option").length)&&"1"<r&&($(this).droppable("disable"),$('.childItem.selected .match-drop-target[data-match-group="'+a+'"]').each(function(){n=$(this).find(".match-option").length,l=$(this).data("maxSelections"),n<l&&0})),c<=s&&($(this).parents(".response-area-match").find(".match-drop-target").each(function(){n=$(this).find(".match-option").length,$(this).data("minSelections")<=n&&o++}),"function"==typeof answerItem?o<d?deAnswerItem($(this)):answerItem($(this)):console.warn("Missing tabs.js.")),$(".match-drop-target .match-option").draggable({revert:function(e){if(!e)return $(this).delay(400).queue(function(e){$(this).removeClass("hidden"),e()}),"invalid";a=$(this).parent().data("matchGroup"),$(this).closest(".match-drop-target").droppable("enable"),$(this).remove(),$(".childItem.selected .match-source-tray").find('.match-option[data-match-group="'+a+'"]').removeClass("inactive")},revertDuration:400,containment:".childItem.selected .response-area-match",helper:"clone",scroll:!0,start:function(){$(this).addClass("hidden")}})}}),$(".match-source-tray").droppable({accept:".match-drop-target .match-option",drop:function(e,t){if($(".match-option").each(function(){var e=t.draggable.text();$(this).text()==e&&$(this).removeClass("hidden")}),"function"==typeof deAnswerItem)return deAnswerItem($(this));console.warn("Missing tabs.js.")}}),$(".response-area-match .btn-clear-answer").click(function(e){if($(this).parents(".response-area-match").find(".match-source-tray .match-option").removeClass("hidden"),$(this).parents(".response-area-match").find(".match-drop-target .match-option").remove(),$(this).parents(".response-area-match").find(".match-drop-target").droppable("enable"),$(this).parents(".response-area-match").find(".match-option").removeClass("inactive"),"function"==typeof deAnswerItem)return deAnswerItem($(this));console.warn("Missing tabs.js.")})}),addUniqueID($(".response-area-mc"),"mc-"),$(".response-area-mc").each(function(){var e,t=$(this),a=t.find("input");addUniqueID(a,(e=t.attr("id"))+"-"),a.attr("name",e)}),function(){var e;e=function(){var e,t,a,s,n,i,o,r,l,c,d,u,p,h,f,m,b,g,v,w;for(t=0,n=(m=$(".response-area-mc")).length;t<n;t++)h=m[t],e=function(t){return function(){var e=t.find(".mc-option");if(e.removeClass("mc-selected"),e.find("input").prop("checked",!1),"function"==typeof deAnswerItem)return deAnswerItem(e);console.warn("Missing tabs.js.")}},$(h).find(".btn-clear-answer").click(e($(h)));for(a=0,i=(b=$(".mc-option")).length;a<i;a++)h=b[a],e=function(t){return function(e){if(e.stopPropagation(),t.find(".mc-eliminate-choice").focus(),t.toggleClass("mc-eliminated"),t.hasClass("mc-eliminated"))return"function"==typeof deAnswerItem?deAnswerItem(t):console.warn("Missing tabs.js."),t.find("input").prop("checked",!1),t.removeClass("mc-selected")}},$(h).find(".mc-eliminate-choice").first().parent().click(e($(h)));for(s=0,o=(g=$(".mc-multiple-select .mc-option")).length;s<o;s++)h=g[s],e=function(e){return function(){e.hasClass("tts-active")||(e.toggleClass("mc-selected"),e.hasClass("mc-selected")?e.find("input").prop("checked",!0):e.find("input").prop("checked",!1),e.find("input").focus(),e.hasClass("mc-selected")&&e.removeClass("mc-eliminated"),d=parseInt(e.parents(".response-area-mc").data("minSelect")),p=e.parent().find(".mc-selected").length,"function"==typeof answerItem?((d==p||Number.isNaN(d))&&answerItem(e),p<d&&deAnswerItem(e)):console.warn("Missing tabs.js."))}},$(h).click(e($(h)));for(c=0,r=(v=$(".mc-single-select")).length;c<r;c++)for(f=v[c],u=0,l=(w=$(f).find(".mc-option")).length;u<l;u++)h=w[u],e=function(e){return function(){if(!e.hasClass("tts-active"))return"function"==typeof answerItem?answerItem(e):console.warn("Missing tabs.js."),e.addClass("mc-selected"),e.find("input").prop("checked",!0).focus(),e.removeClass("mc-eliminated"),e.siblings(".mc-option").find("input").prop("checked",!1),e.siblings(".mc-option").removeClass("mc-selected")}},$(h).click(e($(h)))},$(function(){return window.mcController=new e})}.call(this),$(".mc-single-select .control input").keydown(function(e){var t=$(this),a=t.parents(".mc-option"),s=t.parents(".mc").find("input"),n=a.find(".mc-eliminate-choice"),i=a.prev().find(".mc-eliminate-choice");switch(e.which){case 9:if(e.shiftKey){if(t.is(s.eq(0)))return;e.preventDefault(),i.focus()}else e.preventDefault(),n.focus()}}),$(".mc-single-select .mc-eliminate-choice").keydown(function(e){var t=$(this),a=t.parents(".mc-option"),s=t.parents(".mc").find(".mc-eliminate-choice"),n=a.find("input"),i=a.next().find("input");switch(e.which){case 9:if(e.shiftKey)e.preventDefault(),n.focus();else{if(t.is(s.last()))return;e.preventDefault(),i.focus()}}}),$(".nl-zoom-preview").click(function(){toggleZoomPreview($(this))}),$(".nl-zoom-span, .btn-undo").keyup(function(e){var t=$(this),a=e.keyCode?e.keyCode:e.which;t.is(":focus")&&9==a&&toggleZoomPreview(t)}),$(".response-area-selectable-table tbody tr").click(function(){var e=$(this),t=e.find("input");e.is("input")||(t.trigger("click"),t.focus())}),$(".stim-table input").on("click",function(e){tableToggleSelected($(this).parents("tr")),console.log($(this).prop("checked"))}),$(".response-area-selectable-table .btn-clear-answer").click(function(){tableClearAnswer($(this))}),$(".ft-center-point").mousedown(function(){$(this).siblings(".line").addClass("active")}),$(".ft-center-point").on("touchstart",function(){$(this).siblings(".line").addClass("active")}),$(document).mouseup(function(){$(".line").removeClass("active")}),$(document).on("touchend",function(){$(".line").removeClass("active")}),function(){var e=$(".sis-response-area"),t=$(".sis-media-selection");e.each(function(){setSIScolumns($(this)),setPlaceholders($(this))}),t.each(function(){placeMediaSelections($(this))}),addSISUniqueIDs()}(),$(".sis-text-selection").click(function(e){SISselectionController($(this))}),$(".sis-text-selection").keypress(function(e){var t=e.which;13!=t&&32!=t||(e.preventDefault(),SISselectionController($(this)))}),$(document).click(function(e){var t=".sis-media-selection",a=".sis-media-btn-secondary",s="sis-media-active",n=$(e.target),i=n.parents(t);if(n.is(".sis-media-btn-primary"))i.toggleClass(s),i.hasClass(s)?($(a).attr("tabindex",-1),i.siblings(t).removeClass(s),n.siblings(a).attr("tabindex",0)):n.siblings(a).attr("tabindex",-1);else if(n.is(".sis-media-btn-play")||n.is(".sis-media-btn-play span"))playVideoClip(n);else if(n.is(".sis-media-btn-add")||n.is(".sis-media-btn-add span"))SISselectionController(i);else{if(n.is("#mediaContainer *"))return;resetSISMedia()}}),$(document).on("click",".sis-selection-container .btn-close",function(){removeSISselection($(this),"task"),"function"==typeof answerItem?deAnswerItem($(".childItem.selected").find(".sis-selection-container")):console.warn("Missing tabs.js."),MoreBtnController(300)}),$(".sis-alert-close").click(function(e){$(".sis-alert").removeClass("pulse"),closeMaxSelectAlert(),clearTimeout(fadeOut)}),$(document).on("click",".btn-see-more",function(){$(this).closest(".sis-selection-container").toggleClass("expanded"),MoreBtnController()}),function(){var e=$(".response-area-soe").find(".control-group input"),t=$(".dl-section"),a=$(".dl-primary-stroke"),s=$(".dl-secondary-stroke"),n="dl-dashed-stroke",i="dl-initial-state";function o(e){t.removeClass(i),e.addClass(i).toggleClass("active")}e.click(function(){var e,t=$(this).val();"line-1-solid"==(e=t)?a.removeClass(n):"line-1-dashed"==e?a.addClass(n):"line-2-solid"==e?s.removeClass(n):"line-2-dashed"==e&&s.addClass(n)}),t.click(function(){o($(this))}),t.keydown(function(e){var t=$(this);switch(e.which){case 13:case 32:o(t)}}),t.blur(function(){$(this).removeClass(i)})}(),function(){var e;e=function(){var a,s,e,t,n,i,o,r,l,c,d,u,p,h,f,m,b,g,v,w,C,y,k,x,S,I,P,T,z,L,E,A,q,M,B,D,_,N,H;for(t=0,o=(k=$(".response-area-text-entry")).length;t<o;t++)for(B=k[t],n=0,r=(x=$(B).find("input[type=text], textarea")).length;n<r;n++)E=x[n],e=function(t){return function(e){s=t.parents(".response-area-text-entry").find("input[type=text], textarea").filter(function(){return!$.trim(this.value)}),"function"==typeof deAnswerItem?s.length?deAnswerItem(t):answerItem(t):console.warn("Missing tabs.js.")}},$(E).on("keyup",e($(E)));for(i=0,l=(S=$(".response-area-text-entry")).length;i<l;i++){for(D=S[i],f=0,c=(I=$(D).find(".numeric-entry")).length;f<c;f++)A=I[f],e=function(t){return function(e){if(b=parseInt(t.data("maxValue")),g=parseInt(t.data("minValue")),m=parseInt(t.data("maxLength")),a=t.val().length,e.which<48||57<e.which)return t.addClass("dialog-originator no-change"),"function"==typeof openDialog?openDialog("validation",$(this),g,b,m):console.warn("Missing dialogs.js."),void t.removeClass("no-change")}};$(A).on("keypress",e($(A)))}for(v=0,d=(P=$(".response-area-text-entry")).length;v<d;v++){for(_=P[v],w=0,u=(T=$(_).find(".numeric-entry")).length;w<u;w++)q=T[w],e=function(e){return function(){if(H=this.value,b=parseInt(e.data("maxValue")),g=parseInt(e.data("minValue")),H.length&&!e.hasClass("no-change"))return b<H||H<g?(e.val(""),e.addClass("dialog-originator"),"function"==typeof openDialog?openDialog("validation",$(this),g,b):console.warn("Missing dialogs.js."),"function"==typeof deAnswerItem?deAnswerItem(e):void console.warn("Missing tabs.js.")):void 0}};$(q).on("blur",e($(q)))}for(C=0,p=(z=$(".response-area-text-entry")).length;C<p;C++){for(N=z[C],y=0,h=(L=$(N).find("input[type=text], textarea")).length;y<h;y++)M=L[y],e=function(e){return function(){if(m=parseInt(e.data("maxLength")),a=e.val().length,m<a)return e.addClass("dialog-originator"),e.val(e.val().substring(0,m)),void("function"==typeof openDialog?openDialog("validation",$(this),g,b,m):console.warn("Missing dialogs.js."))}};$(M).on("input",e($(M)))}},$(function(){return window.TextEntryController=new e})}.call(this),function(){var e;e=function(){var e,t,a,s,n,i,o,r,l,c,d,u,p,h,f,m,b,g,v,w,C,y,k,x,S,I,P,T;for(s=0,l=(C=$(".response-area-zones")).length;s<l;s++)g=C[s],fn=function(t){return function(){var e=t.find("a");if(e.removeClass("zones-selected"),"function"==typeof deAnswerItem)return deAnswerItem(e);console.warn("Missing tabs.js.")}},$(g).find(".btn-clear-answer").click(fn($(g)));for(n=0,r=(w=$("svg.zones-mask")).length;n<r;n++)for(T=w[n],i=0,c=(y=$(T).find(".zones-mask-border")).length;i<c;i++)a=y[i],e=(t=$(a)).prev(),t.data("background",e);for(m=function(a){return function(){var e,t;a.toggleClass("zones-selected"),t=a.parent().find("a.zones-selected").length,e=parseInt(a.parents(".response-area-zones").data("minSelect")),a.attr("class").split(/\s+/),"function"==typeof answerItem?((e==t||Number.isNaN(e))&&answerItem(a),t<e&&deAnswerItem(a)):console.warn("Missing tabs.js.")}},P=function(t){return function(){var e;if((e=t.parents(".zones-mask").find("a")).removeClass("zones-selected"),t.addClass("zones-selected"),"function"==typeof answerItem)return answerItem(e);console.warn("Missing tabs.js.")}},o=0,d=(k=$(".response-area-zones.zones-multiple-select svg.zones-mask")).length;o<d;o++)for(T=k[o],f=0,u=(x=$(T).find("a")).length;f<u;f++)t=x[f],$(t).click(m($(t)));for(b=0,p=(S=$(".response-area-zones.zones-single-select svg.zones-mask")).length;b<p;b++)for(T=S[b],v=0,h=(I=$(T).find("a")).length;v<h;v++)t=I[v],$(t).click(P($(t)))},$(function(){return window.zonesController=new e})}.call(this),$(".response-area-zones svg.zones-mask a").keypress(function(e){switch(e.which){case 13:case 32:e.preventDefault(),$(this).trigger("click")}});var baseZoom=parseFloat($("html").css("font-size")),state={help:"off",theme:"default",zoom:0,lang:"eng",tts:"off",sw:"off","sw-mode":"pencil",ee:"off",calc:"off",nav:"start","ereader-panel":"closed",dialog:"closed",wizard:"closed"};function updateState(e,t){if(0<=!["help","theme","zoom","lang","tts","sw","sw-mode","ee","calc","nav","ereader-panel","dialog","wizard"].indexOf(e)&&"enabled"==t?($(e).removeAttr("disabled"),delete state[e]):state[e]=t,"on"==state.timer?($("#timer-btn").addClass("active"),$("#timer-tray").removeClass("hidden")):"off"==state.timer&&($("#timer-btn").removeClass("active"),$("#timer-tray").addClass("hidden")),changeSWMode(state["sw-mode"]),"on"==state.sw)return disableUI(),turnOffTTS(),state.tts="off",turnOffEE(),state.ee="off",turnOffCalc(),state.calc="off",void turnOnSW(e);for(var a in"off"==state.sw&&(enableUI(),turnOffSW()),"on"==state.tts?"ee"==e&&"on"==t||(turnOffEE(),state.ee="off",disableUI(),turnOnTTS(),sendMessage("tts,on")):"off"==state.tts&&(enableUI(),turnOffTTS(),sendMessage("tts,off")),"on"==state.help?$("#help-btn").addClass("active"):"off"==state.help&&$("#help-btn").removeClass("active"),"theme"==e&&("default"==state.theme?(changeColorTheme("default"),sendMessage("theme,default")):"beige"==state.theme?(changeColorTheme("beige"),sendMessage("theme,beige")):"dark"==state.theme&&(changeColorTheme("dark"),sendMessage("theme,dark"))),changeZoom(state.zoom),"eng"==state.lang?changeLanguage("eng"):"esp"==state.lang&&changeLanguage("esp"),"on"==state.ee?turnOnEE():"off"==state.ee&&turnOffEE(),"on"==state.calc?turnOnCalc():"off"==state.calc&&turnOffCalc(),"start"==state.nav?($("#back-btn").attr("disabled",!0),$("#next-btn").removeAttr("disabled"),"nav"==e&&$("#next-btn").focus()):"middle"==state.nav?($("#back-btn").removeAttr("disabled"),$("#next-btn").removeAttr("disabled")):"end"==state.nav&&($("#back-btn").removeAttr("disabled"),$("#next-btn").attr("disabled",!0),"nav"==e&&$("#back-btn").focus()),"open"==state["ereader-panel"]?openEreaderPanel():"closed"==state["ereader-panel"]&&closeEreaderPanel(),"open"==state.dialog&&($("#help-btn, #scratchwork-btn, #equation-btn, #calc-btn, #next-btn, #back-btn").attr("disabled",!0),turnOffEE(),state.ee="off",$("#contentarea").find(ttsFocusRings).attr("tabindex",-1),$("#contentarea").find(ttsBorders).removeClass("tts-active"),setTimeout(function(){$(".scroll-indicator").attr("tabindex",-1)},301)),"open"==state.wizard&&$("#scratchwork-btn, #equation-btn, #calc-btn, #next-btn, #back-btn").attr("disabled",!0),state)"disabled"==state[a]&&$(a).attr("disabled",!0)}function addUniqueID(e,t){var a=1;e.each(function(){$(this).attr("id",t+a),a++})}function pauseMedia(){$(".char-wrapper").removeClass("char-vo-play"),$("video, audio").each(function(){$(this).get(0).pause()})}function resetWriting(){$(".wri-dropdown-wrapper").removeClass("active"),$(".wri-dialog-backdrop").addClass("hidden"),$("[class*=toggle]").removeClass("active")}function resetSISMedia(){$(".sis-media-selection").removeClass("sis-media-active"),$(".sis-media-btn-secondary").attr("tabindex",-1)}function resetSISMaxSelect(){$(".sis-alert").addClass("hidden").removeClass("pulse"),$(".sis-alert-close").attr("disabled",!0),$(".sis-selection-originator").removeClass("sis-selection-originator")}function updatePageButtons(e){document.dispatchEvent(new CustomEvent("updatePageButtons",{detail:{state:e}}))}var standardList="textarea, input[type=text], input[type=radio]:not(.step-indicator input), input[type=checkbox], input[type=range], select, .btn, .footnote-btn, .media-btn, .media-container, .btn-dialog-close, .mc, .mc-eliminate-choice, table.grid, .inline-choice, .match-option, .sis-media-selection, .sis-media-btn-primary, .btn-close, .response-area-selectable-table, .ruler-draggable, .layer-switch-wrapper, #QuestionsButton, #wri-editor-toolbar button, .wri-dialog button, .wri-combobox, .bg-bar, .obj-translatable, .obj-resizable, .obj-rotatable, .coord-grid text, .shape-prepop, .asymptote-handle, .shape-transformable, .sb-source .point, .sb-source .line, .ft-center-point, .char-portrait",customList="a, .accordion span, .tablesorter th.header, .inline-choice > span, .sis-text-selection, .handle-size, .point:not(.sb-source .point, .ft-center-point), .line:not(.sb-source .line), .sb-source, .asymptote, .nl-point, .nl-segment, .bw-actual, .dl-section, .nl-zoom-span, .ft-source";function disableUI(){var e=$(standardList),t=$(customList);e.attr("disabled",!0),t.attr("disabled",!0).attr("tabindex",-1),pauseMedia(),resetWriting(),resetSISMedia(),resetSISMaxSelect(),updatePageButtons("disable"),$(".inline-choice").removeClass("active"),$(".match-option").length&&$(".match-option").draggable("disable")}function enableUI(){var e=$(standardList),t=$(customList);e.removeAttr("disabled"),t.removeAttr("disabled").attr("tabindex",0),updatePageButtons("enable"),$(".cta-submit-wrapper .cta-message").attr("tabindex",-1),$(".match-option").length&&$(".match-option").draggable("enable")}function changeColorTheme(e){var t;$("head .beige-stylesheet").remove(),$("head .dark-stylesheet").remove(),"default"!=e&&((t=document.createElement("link")).setAttribute("rel","stylesheet"),t.setAttribute("class",e+"-stylesheet"),t.setAttribute("href","../shared/color-theme-"+e+".css"),document.querySelector("head").appendChild(t))}function changeZoom(e){0==e?($("html").css("font-size",baseZoom),$("#zoom-out-btn").attr("disabled",!0),$("#zoom-in-btn").removeAttr("disabled")):1==e?($("html").css("font-size",1.333*baseZoom),$("#zoom-out-btn").removeAttr("disabled"),$("#zoom-in-btn").removeAttr("disabled")):2==e?($("html").css("font-size",1.667*baseZoom),$("#zoom-out-btn").removeAttr("disabled"),$("#zoom-in-btn").removeAttr("disabled")):3==e&&($("html").css("font-size",2*baseZoom),$("#zoom-out-btn").removeAttr("disabled"),$("#zoom-in-btn").attr("disabled",!0)),"function"==typeof MoreBtnController&&MoreBtnController(100)}function changeLanguage(e){var t;"eng"==e?t=$("#change-lang-btn"):"esp"==e&&(t=$("#change-lang-btn2")),t.removeClass("hidden"),t.siblings(".change-lang-class").addClass("hidden"),$("#change-lang-btn2-eng-box").toggleClass("slide-left"),$("#change-lang-btn-esp-box").toggleClass("slide-right"),$(".arrow").toggleClass("fade-in"),t.siblings(".change-lang-class").focus()}function bindEvent(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent&&e.attachEvent("on"+t,a)}var sendMessage=function(e){window.parent.length&&window.parent.postMessage(e,"*")};bindEvent(window,"message",function(e){var t=e.data.split(",");updateState(t[0],t[1])});var ttsBorders=".stimulus-paragraph p, .stem-paragraph-inner, .stem-paragraph p, .standalone-image, .mc-option, table.grid tr, .match-option-text, .footnote-paragraph, .list-unordered li, .alert p, .cta-message, .char-portrait figcaption p, .char-text p, .char-text h3 span, .sis-selection-header p, .wizard h3, .wizard p, .response-area-iic, .stim-table tr, .match-background",ttsFocusRings=".stimulus-paragraph p, .stem-paragraph-inner, .stem-paragraph p, .standalone-image, .mc-content:not(.nl-control-wrapper .mc-content), .grid-content, .match-option-text, .footnote-paragraph, .list-unordered li, .alert p, .cta-message, .char-portrait figcaption p, .char-text p, .char-text h3 span, .sis-selection-header p, .wizard h3, .wizard p, .response-area-iic, .table-content, .match-background";function turnOnTTS(){var e=$(ttsBorders),t=$(ttsFocusRings);$(".dialog .btn").removeAttr("disabled"),$("#read-aloud-btn").addClass("active"),e.addClass("tts-active"),t.attr("tabindex",0)}function turnOffTTS(){var e=$(ttsBorders),t=$(ttsFocusRings);$("#read-aloud-btn").removeClass("active"),e.removeClass("tts-active"),t.removeAttr("tabindex"),$(".cta-submit-wrapper .cta-message").attr("tabindex",-1)}function turnOnSW(e){$(".system-btn:not(#scratchwork-btn):not(#timer-btn), .btn-nav").attr("disabled",!0),$(".enaepTab li").attr("disabled",!0),$(".btn-tab-mover").attr("disabled",!0),$(".step-indicator input").attr("disabled",!0),$(".footnote-content").removeClass("active"),$(".childItem.selected, #stimulus").find(".scratchwork-canvas").addClass("active"),$("#scratchwork-btn").removeAttr("disabled").addClass("active"),$("#scratchwork-tray").removeClass("hidden"),"sw"==e&&($(".tray-btn").removeClass("active"),$("#pencil-btn").addClass("active"),$(".tray-btn").removeAttr("disabled"),$("#pencil-btn").attr("disabled",!0),state["sw-mode"]="pencil")}function turnOffSW(){$(".system-btn, .btn-nav").removeAttr("disabled"),$(".enaepTab li").removeAttr("disabled"),$(".btn-tab-mover").removeAttr("disabled"),$(".step-indicator input").removeAttr("disabled"),$(".childItem.selected, #stimulus").find(".scratchwork-canvas").removeClass("active"),$("#scratchwork-btn").removeClass("active"),$("#scratchwork-tray").addClass("hidden"),$(".tray-btn").attr("disabled",!0)}function changeSWMode(e){$(".tray-btn").removeClass("active"),$(".tray-btn").removeAttr("disabled"),"pencil"==e?($("#pencil-btn").attr("disabled"),$("#pencil-btn").addClass("active")):"highlighter"==e?($("#highlighter-btn").attr("disabled"),$("#highlighter-btn").addClass("active")):"eraser"==e&&($("#eraser-btn").attr("disabled"),$("#eraser-btn").addClass("active"))}function turnOnEE(e){var t,a=$(".contentarea-inner"),s=$("#equation-btn"),n=$("#ee-wrapper"),i=$(".ee-tabs li"),o=$("#ee-btn-close"),r=$(".ee-focus");n.removeClass("hidden"),s.addClass("active"),enableUI(),turnOffTTS(),state.tts="off",sendMessage("tts,off"),i.attr("tabindex",0),o.attr("tabindex",0),r.length&&(t=r.position(),a.animate({scrollTop:t.top},300),enableEquationEditor(r),r.focus()),"function"==typeof MoreBtnController&&MoreBtnController(300)}function turnOffEE(){var e=$("#ee-wrapper"),t=$(".ee-tabs li"),a=$("#equation-btn"),s=$("#ee-btn-close"),n=$("input[type=text], textarea");e.addClass("hidden"),a.removeClass("active"),t.attr("tabindex",-1),s.attr("tabindex",-1),disableEquationEditor($("#equation-btn")),n.removeClass("ee-active").removeClass("ee-focus"),"function"==typeof MoreBtnController&&MoreBtnController(300)}function enableEquationEditor(e){var t=$("#ee-wrapper"),a=$(".ee-btnarea .ee-btn"),s=$(".ee-numeric-btn");t.hasClass("hidden")?e.addClass("ee-focus"):(disableEquationEditor(e),e.addClass("ee-active").addClass("ee-focus"),e.is(".numeric-entry")?s.removeAttr("disabled"):a.removeAttr("disabled"))}function disableEquationEditor(e){var t=$(".ee-tabs li"),a=$(".ee-btnarea"),s=a.find(".ee-btn"),n=$("input[type=text], textarea");e.is(".numeric-entry")&&(t.removeClass("selected"),t.first().addClass("selected"),a.hide(),a.first().show()),s.attr("disabled",!0),n.removeClass("ee-active").removeClass("ee-focus")}function turnOnCalc(){$("#calc-btn").addClass("active")}function turnOffCalc(){$("#calc-btn").removeClass("active")}function openEreaderPanel(){$("#QuestionsPanel").length&&($("#QuestionsButton").addClass("panel-down"),$("#QuestionsPanel").removeClass("hidden"),$("#QuestionsButton-label").html("Hide<br>Questions"),$("#mask").removeClass("hidden"))}function closeEreaderPanel(){$("#QuestionsPanel").length&&($("#QuestionsButton").removeClass("panel-down"),$("#QuestionsPanel").addClass("hidden"),$("#QuestionsButton-label").html("Show<br>Questions"),$("#mask").addClass("hidden"),$("#back-btn, #next-btn").attr("disabled",!0))}function Footnote(e){this.ft=e,this.initEvents()}function navButtonController(e){var t=$(".step-indicator input").length-1,a=$(".step-indicator input").eq(e),s=a.siblings(".step-indicator input");e<1?updateState("nav","start"):1<=e&&e<t?updateState("nav","middle"):t<=e&&updateState("nav","end"),a.removeClass("step-indicator-complete"),s.each(function(){s.index(this)>=e?$(this).removeClass("step-indicator-complete"):s.index(this)<e&&$(this).addClass("step-indicator-complete")}),updateState("tts","off")}function createSliderTicks(e,t){var a=e.attr("id")+"-"+(t+1),s=e.find("#"+a).data("label"),n=e.find(".slider-labels"),i=e.find(".slider-dots"),o='<div class="slider-label-tick enabled" id="'+a+'-label"><span>'+s+"</span></div>",r='<div id="'+a+'-dot" class="slider-dot enabled"></div>';n.append(o),i.append(r)}function evalSliderPosition(e,a,s){var n;return $.each(e,function(e,t){t-a<=s&&s<=t+a&&(n=t)}),n}function updateSlider(e,t){var a=e.parents(".slider-wrapper"),s=a.find(".slider-img"),n="#"+a.attr("id")+"-"+(t+1),i=$(n),o=a.find(".slider-label-tick"),r=$(n+"-label"),l=a.find(".slider-dot"),c=$(n+"-dot"),d="closest";s.addClass("hidden"),i.removeClass("hidden"),o.removeClass("active"),r.addClass("active"),l.removeClass(d),c.addClass(d)}function initializeSlider(e){var t,a=e.attr("id"),s=e.find(".slider"),n=e.find(".slider-img"),i=n.length-1,o=[];for(addUniqueID(n,a+"-"),n.addClass("hidden"),n.eq(0).removeClass("hidden"),t=0;t<=i;t++)o.push(t),createSliderTicks(e,t);$(".slider-label-tick").eq(0).addClass("active"),$(".slider-dot").eq(0).addClass("closest"),s.attr("max",i),s.on("input",function(){var e=$(this),t=e.val();updateSlider(e,evalSliderPosition(o,.5,t))}),s.change(function(){var e=$(this),t=e.val(),a=evalSliderPosition(o,.5,t);e.val(a)}),s.keydown(function(e){var t=$(this),a=parseInt(t.val()),s=t.attr("min"),n=t.attr("max");switch(e.which){case 37:case 38:e.preventDefault(),s<a&&(a-=1,t.val(a),updateSlider(t,evalSliderPosition(o,.5,a)));break;case 39:case 40:e.preventDefault(),a<n&&(a+=1,t.val(a),updateSlider(t,evalSliderPosition(o,.5,a)))}})}!function(){var t,a=!1,s="";document.addEventListener("touchstart",function(e){clearTimeout(t),a=!0,"can-touch"!=s&&(s="can-touch",document.documentElement.classList.add(s)),t=setTimeout(function(){a=!1},500)},!1),document.addEventListener("mouseover",function(e){a||"can-touch"!=s||(a=!1,s="",document.documentElement.classList.remove("can-touch"))},!1)}(),function(){var e="input[type=range], input[type=checkbox], .ui-slider-handle, .point, .line, .asymptote, .nl-point, .nl-segment, .handle-size, .bw-actual, .dl-section, .ft-source";$(document).on("keyup",e,function(e){var t=$(this),a=e.keyCode?e.keyCode:e.which;if(t.is(":focus"))switch(a){case 9:case 37:case 38:case 39:case 40:t.addClass("focus-tabbed")}}),$(document).on("blur mousedown",e,function(e){$(this).removeClass("focus-tabbed")})}(),Footnote.prototype={initEvents:function(){var t,a,s,n,i,o,r;this.ft.on("click",function(e){t="#"+$(this).attr("id").concat("-content"),o=$(this).position(),r=$(this).outerWidth(),a=$(t).outerHeight(),i=$(t).outerWidth(),n=o.top-a-11,s=o.left-.5*i+.5*r+3,$(this).addClass("footnote-originator"),$(t).css({top:n,left:s}),$(t).toggleClass("active"),$(t).siblings(".footnote-content").removeClass("active"),$(t).children(".footnote-close").focus(),e.stopPropagation()})}},$(function(){new Footnote($(".footnote-btn"));$(".footnote-close").click(function(e){$(".footnote-originator").focus(),$(".footnote-originator").removeClass("footnote-originator"),$(".footnote-content").removeClass("active")})}),$("#back-btn").click(function(){var e=$(".step-indicator input:checked"),t=$(".step-indicator input").index(e)-1;$(".step-indicator input").eq(t).prop("checked",!0),navButtonController(t)}),$("#next-btn").click(function(){var e=$(".step-indicator input:checked"),t=$(".step-indicator input").index(e)+1;$(".step-indicator input").eq(t).prop("checked",!0),navButtonController(t)}),$(".step-indicator input").click(function(){var e=$(this);navButtonController($(".step-indicator input").index(e)),e.focus()}),$(".layer-switch input").change(function(e){var t;t=$(this).attr("id").replace("layer-btn-","#layer-"),$(t).toggleClass("hidden"),$(this).toggleClass("active"),$(this).parent().siblings(".layer-switch-label").toggleClass("active")}),$(".layer-switch-label").click(function(e){$(this).siblings(".layer-switch").children("input").click().focus()}),$(".layer-switch input").keypress(function(e){switch(e.which){case 13:e.preventDefault(),$(this).trigger("click")}}),$(function(){var e=$("<div>",{class:"ui-rotatable-handle"}).clone(),t=$(".ruler-draggable"),a=t.offset().top,s=t.outerHeight(),n=t.outerWidth()/2,i=$(".ruler-drag-handle"),o=i.offset().top,r=i.outerHeight()/2,l=s+(o-(a+s))+r,c=$(".ruler-wrapper").offset().top;$(".ruler-draggable-outer").draggable({cancel:".ui-rotatable-handle",handle:".ruler-drag-handle, .ruler-draggable"}),$(".ruler-draggable").rotatable({rotationCenterOffset:{top:l,left:n}}),$(".ruler-draggable .ui-rotatable-handle").addClass("btn btn-circular icon- ui-rotatable-handle-left"),e.addClass("btn btn-circular icon- ui-rotatable-handle-right"),$(".ruler-draggable").append(e),$(".ruler-draggable div[class*='ui-rotatable-handle-']").bind("mousedown",function(e){$(".ruler-draggable").rotatable("instance").startRotate(e)}),$(".btn-reset").click(function(e){$(this).siblings(".ruler-draggable-outer").css({left:0,top:a-c}),$(".ruler-draggable").data("uiRotatable").angle(0)})}),$(".slider-wrapper").each(function(){var e=$(this);addUniqueID(e,"slider-"),initializeSlider(e)}),$(document).ready(function(){$(".stim-table").tablesorter({cancelSelection:!1,headers:{0:{sorter:!1},1:{sorter:!1}}}),$("th.header").keydown(function(e){switch(e.which){case 13:case 32:e.preventDefault(),$(this).trigger("click")}})}),$("#help-btn").click(function(){"on"==state.help?updateState("help","off"):updateState("help","on")}),$("#theme-btn").click(function(){"default"==state.theme?updateState("theme","beige"):"beige"==state.theme?updateState("theme","dark"):"dark"==state.theme&&updateState("theme","default")}),$("#zoom-out-btn").click(function(){zoomState=state.zoom,zoomState--,updateState("zoom",zoomState),0==zoomState&&$("#zoom-in-btn").focus()}),$("#zoom-in-btn").click(function(){zoomState=state.zoom,zoomState++,updateState("zoom",zoomState),3==zoomState&&$("#zoom-out-btn").focus()}),$("#change-lang-btn, #change-lang-btn2").click(function(){"eng"==state.lang?updateState("lang","esp"):"esp"==state.lang&&updateState("lang","eng")}),$("#read-aloud-btn").click(function(){"on"==state.tts?updateState("tts","off"):updateState("tts","on")}),$("#scratchwork-btn").click(function(){"on"==state.sw?updateState("sw","off"):updateState("sw","on")}),$("#pencil-btn").click(function(){updateState("sw-mode","pencil")}),$("#highlighter-btn").click(function(){updateState("sw-mode","highlighter")}),$("#eraser-btn").click(function(){updateState("sw-mode","eraser")}),$("#equation-btn, #ee-btn-close").click(function(){"on"==state.ee?updateState("ee","off"):updateState("ee","on"),$("#equation-btn").focus()}),$("#calc-btn").click(function(){"on"==state.calc?updateState("calc","off"):updateState("calc","on")}),$("#timer-btn").click(function(){"on"==state.timer?updateState("timer","off"):updateState("timer","on")}),$(function(){$(".obj-translatable").draggable({containment:"parent",grid:[24,24]}),$(".obj-resizable").resizable({classes:{"ui-resizable-handle":"handle-size-multi"},containment:"parent",grid:24,handles:"n, e, s, w, ne, se, sw, nw",minHeight:72,minWidth:120}),$(".obj-rotatable").rotatable()}),$(".handle-size").keydown(function(e){switch(e.keyCode?e.keyCode:e.which){case 38:case 37:case 39:case 40:e.preventDefault(),$(this).addClass("active")}}),$(".handle-size").keyup(function(){$(this).removeClass("active")}),function(){var e,u,s=$(".wizard-backdrop"),p=$(".wizard"),h=$(".wizard-content"),f=h.length,n=$("#btn-back-wizard"),i=$("#btn-next-wizard"),t=($(".wizard-nav-wrapper"),$(".wizard-nav-array")),o=($("#theme-btn"),$("#scratchwork-btn"),$("#next-btn")),m="wizard-active",b="wizard-viewed",g="wizard-active",r="wizard-hidden",l="hidden";function a(e){var t=$(".wizard-content.wizard-active"),a=h.index(t);updateState("tts","off"),1==e?a++:a--,function(e,t){var a=h.eq(e),s=a.data("cardSize"),n=h.eq(e-1),i=$(".wizard-content.wizard-active").data("cardSize"),o=u.eq(e),r="large";e<f&&(h.removeClass(m),u.removeClass(g),h.find(".wizard-animation").hide());0<=e-1&&e<f&&n.addClass(b);s==r?p.addClass(r):p.removeClass(r);s==r&&i!=r?h.fadeOut(0).delay(250).fadeIn(200):s!=r&&i==r&&h.fadeOut(0).delay(250).fadeIn(200);a.data("customNextLabel")?(c=(l=a).data("customNextLabel"),d=l.data("customNextTitle"),w(c,d)):v();var l,c,d;a.addClass(m).removeClass(b),o.addClass(g),a.find(".wizard-animation").show(),setTimeout(function(){var e=a.find(".wizard-animation").data("source");a.find(".wizard-animation").attr("src",e)},10)}(a),a==f&&(s.addClass(r),n.attr("tabindex",-1),i.attr("tabindex",-1),updateState("wizard","closed"),o.focus()),1==a?n.removeClass(l):0==a&&(n.addClass(l),i.focus())}function v(){w(i.data("label"),i.data("title"))}function w(e,t){i.find("span").html(e),i.attr("title",t)}!function(){for(updateState("wizard","open"),e=0;e<f;e++)t.append('<div class="wizard-nav-dot"></div>');(u=$(".wizard-nav-dot")).eq(0).addClass(g)}(),n.click(function(){a(0)}),i.click(function(){a(1)}),$("#btn-wizard-restart").click(function(){s.removeClass(r),h.removeClass(m).removeClass(b),u.removeClass(g),h.eq(0).addClass(m),u.eq(0).addClass(m),n.addClass(l).removeAttr("tabindex"),i.removeAttr("tabindex"),v(),updateState("wizard","open"),i.focus()})}(),$(document).ready(function(){var t=0;function a(e){var t=e.outerWidth(),a=e.siblings(".wri-menu").outerWidth(),s=$(window).width()-e.offset().left,n=t-a+1,i=e.siblings(".wri-menu");i.removeClass("wri-dropdown-left").css("left",0),s<=a&&(i.addClass("wri-dropdown-left"),i.css("left",n)),e.parentsUntil("#wri-editor-toolbar").siblings().find(".wri-dropdown-wrapper").removeClass("active"),$("#wri-context-menu").removeClass("active"),$(".wri-menu").find("button, .wri-context-sub-trigger").attr("tabindex",-1),e.parent(".wri-dropdown-wrapper").toggleClass("active"),e.parent(".wri-dropdown-wrapper").hasClass("active")&&i.find("button").attr("tabindex",0)}function d(e){e.addClass("active"),e.find("button").attr("tabindex",0),e.find("button:first-of-type").focus()}function u(){$(".wri-dropdown-wrapper, .wri-menu, .wri-context-sub-trigger").removeClass("active"),$(".wri-menu").find("button, .wri-context-sub-trigger").attr("tabindex",-1)}function p(e){e.removeClass("active"),e.find("button").attr("tabindex",-1),e.focus()}function s(e){var t=function(e){var t=0,a=0;e||(e=window.event);return e.pageX||e.pageY?(t=e.pageX,a=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:a}}(e),a=t.x,s=t.y,n=$("#wri-context-menu"),i=n.outerWidth()+4,o=n.outerHeight()+4,r=window.innerWidth,l=window.innerHeight;r-a<i?n.css("left",r-i+"px"):n.css("left",a+"px"),l-s<o?n.css("top",s-o+"px"):n.css("top",s+"px")}function h(e){e.is(".spelling-toggle")?($(".wri-dialog-backdrop:not(#spell-check-dialog)").addClass("hidden"),$("[class*=toggle]:not(.spelling-toggle)").removeClass("active"),$("#spell-check-dialog").toggleClass("hidden"),$(".spelling-toggle").toggleClass("active")):e.is(".thesaurus-toggle")?($(".wri-dialog-backdrop:not(#thesaurus-dialog)").addClass("hidden"),$("[class*=toggle]:not(.thesaurus-toggle)").removeClass("active"),$("#thesaurus-dialog").toggleClass("hidden"),$(".thesaurus-toggle").toggleClass("active")):e.is(".options-toggle")&&($(".wri-dialog-backdrop:not(#options-dialog)").addClass("hidden"),$("[class*=toggle]").removeClass("active"),$("#options-dialog").toggleClass("hidden"))}function f(e){return e.is(".spelling-toggle")&&!$("#spell-check-dialog").hasClass("hidden")?$("#spell-check-dialog select").focus():e.is(".thesaurus-toggle")&&!$("#thesaurus-dialog").hasClass("hidden")?$("#thesaurus-dialog select").focus():e.is(".options-toggle")&&!$("#options-dialog").hasClass("hidden")?$("#options-dialog input[type=checkbox]").eq(0).focus():void(e.is(".wri-dropdown-wrapper .wri-btn")||$("#wri-editor-actual").focus())}$("#toggleLeft").click(function(e){0==t?($("#taskpane").addClass("taskpane-left"),$("#toggleRight").removeAttr("disabled"),$("#wri-editor-toolbar button:not(.button-sticky-fontsize.active)").removeAttr("tabindex"),$("#wri-editor-actual").removeAttr("tabindex"),$("#start-writing-flag").fadeOut(200),setTimeout(function(){$("#wri-editor-contents-wrapper").css("overflow-x","auto")},450),t=1):1==t&&($("#taskpane").addClass("taskpane-left2"),$("#toggleLeft").attr("disabled",!0),$(".tts-active").attr("tabindex",-1),$("#toggleRight").focus(),updateState("tts","off"),updateState("sw","off"),updateState("#scratchwork-btn","disabled"),updateState("#read-aloud-btn","disabled"),t=2)}),$("#toggleRight").click(function(e){1==t?($("#taskpane").removeClass("taskpane-left"),$("#toggleRight").attr("disabled",!0),$("#toggleLeft").focus(),$("#wri-editor-contents-wrapper").css("overflow-x","hidden"),$(".wri-dialog-backdrop").addClass("hidden"),$("button.spelling-toggle").removeClass("active"),$("button.thesaurus-toggle").removeClass("active"),$("#wri-editor-toolbar button, #wri-editor-actual").attr("tabindex",-1),t=0):2==t&&($("#taskpane").removeClass("taskpane-left2"),$("#toggleLeft").removeAttr("disabled"),$(".tts-active").attr("tabindex",0),updateState("#scratchwork-btn","enabled"),updateState("#read-aloud-btn","enabled"),t=1)}),$(document).click(function(e){var t=$(e.target);1===(e.which||e.button)&&(t.is(".wri-dropdown-wrapper > .wri-btn")?a(t):u())}),$(document).contextmenu(function(e){$(e.target).is("#wri-editor-actual")?(e.preventDefault(),u(),s(e),$("#wri-context-menu").addClass("active"),$("#wri-context-menu").children("button, .wri-context-sub-trigger").attr("tabindex",0),$("#wri-context-menu").children("button:first-of-type").focus()):u()}),$(".wri-context-sub-trigger").mouseover(function(e){var t,a,s,n,i,o,r,l,c,d,u=$(this);a=(t=u).offset().left,s=t.offset().top,n=t.outerWidth(),i=t.outerHeight(),o=t.find(".wri-context-submenu"),r=o.outerWidth()+4,l=o.outerHeight()+4,c=window.innerWidth,d=window.innerHeight,c<a+n+r?o.css("left",3-r+"px"):o.css("left",""),d<s+l?o.css("top",-(l-i-3)+"px"):o.css("top",""),u.addClass("active"),u.find("button").attr("tabindex",0)}),$(".wri-context-sub-trigger").mouseout(function(e){var t=$(this);t.removeClass("active"),t.find("button").attr("tabindex",-1)}),$("button.button-sticky").click(function(e){$(this).toggleClass("active"),$(this).next().hasClass("active")&&$(this).toggleClass("remove-border-radius"),$(this).prev().hasClass("active")&&$(this).prev().toggleClass("remove-border-radius")}),$("button.button-sticky-fontsize").click(function(e){$(this).addClass("active").attr("tabindex",-1),$(this).siblings("button.button-sticky-fontsize").removeClass("active").removeAttr("tabindex")}),$("#wri-editor-contents-wrapper").on("scroll",function(){var e;$(this).scrollTop()<=300&&(e=$(this).scrollTop(),e/=300,$("#wri-editor-top-shadow").css("opacity",e))}),$(".wri-dialog").draggable({handle:".wri-dialog-top-bar",cancel:".close-dialog-btn",containment:"parent"}),$("[class*=toggle]").click(function(){h($(this))}),$(".wri-dialog").mousedown(function(){$(".draggable-dialog-flag").fadeOut(300)}),$(".wri-button-wrapper button, .wri-menu button, .wri-btn").click(function(){f($(this))}),$(".wri-dropdown-wrapper .wri-btn").keydown(function(e){var t=$(e.target);switch(e.which){case 27:u();break;case 13:case 32:e.preventDefault(),a(t),$(this).parents(".wri-dropdown-wrapper").hasClass("active")&&$(this).siblings(".wri-menu").find('button:not([class*="disabled"])').first().focus();break;case 40:e.preventDefault(),$(this).parents(".wri-dropdown-wrapper").hasClass("active")||a(t),$(this).siblings(".wri-menu").find('button:not([class*="disabled"])').first().focus()}}),$(".wri-menu").children().not("hr").keydown(function(e){var t=$(e.target),a=t.closest(".wri-menu"),s=t.parents(".wri-dropdown-wrapper").children(".wri-btn"),n=a.children().not("hr"),i=n.index(e.target),o=n.eq(0),r=n.eq(n.length-1),l=n.eq(i+1),c=n.eq(i-1);switch(e.preventDefault(),e.which){case 9:case 27:a.hasClass("wri-context-submenu")?p(a.closest(".wri-context-sub-trigger")):(u(),s.length?s.focus():$("#wri-editor-actual").focus());break;case 13:case 32:t.is(".wri-context-sub-trigger")?d(t):(t.is("[class*=toggle]")&&(e.stopPropagation(),h(t)),u(),f(t));break;case 36:o.focus();break;case 35:r.focus();break;case 37:p(a.closest(".wri-context-sub-trigger"));break;case 38:t.is(":first-child")?r.focus():c.focus();break;case 39:t.is(".wri-context-sub-trigger")&&d(t);break;case 40:t.is(":last-child")?o.focus():l.focus();break;default:return!1}}),$(".wri-menu").children().not("hr").hover(function(){$(this).focus(),$(this).siblings().removeClass("active")}),$("#wri-editor-actual").each(function(){this.setAttribute("style","height:"+this.scrollHeight+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"}),$("textarea").on("input",function(e){var t=$(this),a=parseInt(t.data("maxLength"));if(a<t.val().length)return t.addClass("dialog-originator"),t.val(t.val().substring(0,a)),void("function"==typeof openDialog?openDialog("validation",$(this),"","",a):console.warn("Missing dialogs.js."))})});